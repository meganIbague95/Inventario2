if (typeof(protocolUrl) == "undefined" )
var protocolUrl = document.location.protocol;

var LANG_MSG = {
"es":{
"trans_no_disponible":"No disponible para este dispositivo",
"trans_no_comenzado" : "La retransmisión aún no ha comenzado",
"trans_reanudara" : "La retransmisión se reanudará en breve",
"trans_finalizada" : "La retransmisión ha finalizado",
"publicidad" : "Publicidad",
"actualizar_plugin" : "Necesitas actualizar tu plugin de Flash",
"no_mp4" : "El navegador no admite vídeo HTML5/MP4",
"no_mp3" : "El navegador no admite audio HTML5/MP3",
"geobloqueado" : "Vídeo no disponible en su zona geográfica",
"bloqueado" : "Contenido compartido bloqueado",
"aun_no_disponible" : "El vídeo no está disponible todavía",
"no_disponible" : "El vídeo ya no está disponible",
"audio_geobloqueado" : "Audio no disponible en su zona geográfica",
"audio_aun_no_disponible" : "Audio no disponible todavía",
"audio_no_disponible" : "Audio ya no disponible",
"audio_no_encontrado": "Audio no encontrado",
"necesita_plugin" : "Necesita instalar el plugin de flash para ver este contenido",
"no_encontrado": "Vídeo no encontrado",
"cerrar" : "Cerrar",
"tamanio_real" : "Tamaño real",
"ver_perfil_eskup" : "Ver perfil en Eskup",
"teclear_usuario" : "Tienes que teclear usuario y contraseña",
"error_correo" : "El campo 'usuario' no parece un correo electrónico. Por favor, revísalo.",
"foto" : "Foto",
"tamanio_ventana" : "Tamaño ventana",
"ver_perfil_completo" : "Ver perfil completo",
"avatar" : "Avatar",
"ver_video": "Ver vídeo",
"vervideo_svg": protocolUrl + "//ep00.epimg.net/reproductores/vervideo.svg",
"siguiente_noticia": "Siguiente noticia",
"anterior_noticia": "Noticia anterior",
"primera_noticia": "No hay noticia anterior",
"ultima_noticia": "No hay más noticias",
"reproducir_video": "Reproducir vídeo"
},
"en":{
"trans_no_disponible" : "Not available on this device",
"trans_no_comenzado" : "Live coverage hasn't started yet",
"trans_reanudara" : "Live coverage will recommence soon",
"trans_finalizada" : "Live coverage has now finished",
"publicidad" : "Advertisement",
"actualizar_plugin" : "Flash player needs to be updated",
"no_mp4" : "The browser doesn't allow HTML5/MP4 video",
"no_mp3" : "The browser doesn't allow HTML5/MP4 audio",
"geobloqueado" : "Video not available in your location",
"bloqueado" : "Shared content blocked",
"aun_no_disponible" : "This video is not yet available",
"no_disponible" : "This video is no longer available",
"audio_geobloqueado" : "Audio not available in your location",
"audio_aun_no_disponible" : "Audio not yet available",
"audio_no_disponible" : "Audio no longer available",
"audio_no_encontrado": "Audio not found",
"necesita_plugin" : "Flash required to view this content",
"no_encontrado": "Video not found",
"cerrar" : "Close",
"tamanio_real" : "Full size",
"ver_perfil_eskup" : "See Eskup profile",
"teclear_usuario" : "Please fill in username and password",
"error_correo" : "The username field doesn't appear to be an e-mail address. Please check it.",
"foto" : "Photo",
"tamanio_ventana" : "Window size",
"ver_perfil_completo" : "See full profile",
"avatar" : "Profile picture",
"ver_video": "Watch video",
"vervideo_svg": protocolUrl + "//ep00.epimg.net/reproductores/vervideo.svg",
"siguiente_noticia": "Next article",
"anterior_noticia": "Previous article",
"primera_noticia": "There is no previous article",
"ultima_noticia": "There are no more articles",
"reproducir_video": "Play video"
}
};
var MPEP_idioma = "es";
var MPEP_responsive = (typeof(MPEP_responsive) != "undefined") ? MPEP_responsive : false;
var MPEP_article = (typeof(MPEP_article) != "undefined") ? MPEP_article : false;
function addParametroURL(url, key, value)
{
var rUrl = url;
var rParams = '';
var rAnchor = '';
var posAnchor = url.indexOf('#');
if(posAnchor > 0)
{
rAnchor = url.substring(posAnchor, url.length);
rUrl = url.substring(0, posAnchor);
}
var rUrl = rUrl.split("?");
var sepTmp = '';
if (rUrl.length > 1)
{
if (rUrl[1] != '')
{
var rParamsTmp = rUrl[1].split('&');
for (var i = 0; (i < rParamsTmp.length); i++)
{
var rParamTmp = rParamsTmp[i].split('=');
if (rParamTmp[0] == '' || key == rParamTmp[0])
continue;
if (rParamTmp.length < 2)
rParamTmp[1] = '';
rParams += sepTmp + rParamTmp[0] + '=' + rParamTmp[1];
sepTmp = '&';
}
}
}
rParams = '?' + rParams + sepTmp + key + '=' + escape(value);
return rUrl[0] + rParams + rAnchor;
}
function parseaMetas() {
var metas = document.getElementsByTagName('meta');
var idioma_meta = "";
var i;
for (i=0; i<metas.length; i++) {
if (metas[i].getAttribute("name") == "lang") {
idioma_meta = (metas[i].getAttribute("content")).toLowerCase();
}
if (metas[i].getAttribute("name") == "viewport")
MPEP_responsive = true;
if(metas[i].getAttribute("property") == "og:type" && metas[i].getAttribute("content") == "article")
MPEP_article = true;
}
if ( LANG_MSG.hasOwnProperty(idioma_meta) ) {
MPEP_idioma = idioma_meta;
}
}
parseaMetas();
if (typeof(LANG) == "undefined")
var LANG = MPEP_idioma;
else
{
if ( !LANG_MSG.hasOwnProperty(LANG) )
{
LANG = "es";
}
}

var isOpera = null;
var isSafari = null;
var isGecko = null;
var isIE = null;
var isMobile = null;
var userAgent = navigator.userAgent.toLowerCase();
var ua=navigator.userAgent, userAgentMatches;
if ((/KHTML/).test(ua)) {
isSafari=1;
}
userAgentMatches=ua.match(/AppleWebKit\/([^\s]*)/);
if (userAgentMatches&&userAgentMatches[1]) {
isSafari=parseFloat(userAgentMatches[1]);
}
if (!isSafari) {
userAgentMatches=ua.match(/Opera[\s\/]([^\s]*)/);
if (userAgentMatches&&userAgentMatches[1]) {
isOpera=parseFloat(userAgentMatches[1]);
} else {
userAgentMatches=ua.match(/MSIE\s([^;]*)/);
if (userAgentMatches&&userAgentMatches[1]) {
isIE=parseFloat(userAgentMatches[1]);
} else {
userAgentMatches=ua.match(/Gecko\/([^\s]*)/);
if (userAgentMatches) {
isGecko=1;
}
}
}
}
var isIphone = false;
var isIpad = false;
if (userAgent.indexOf("iphone") > -1)
isIphone = true
else
if (userAgent.indexOf("ipad") > -1)
isIpad = true;
var iDevice = (isIphone || isIpad);
var dispositivoMovil = iDevice || userAgent.indexOf("android") > -1 || userAgent.indexOf("mobile") > -1;
var isMacSafari = userAgent.match(/mac os .*safari/);
var dimensionesPEP = EPETBrowserDims();
if (typeof(anchoReferenciaMobile) == "undefined" )
var anchoReferenciaMobile = 600;
var ev_reescalado;
EPETaddEvent(window, orientationEvent, function(){
clearTimeout(ev_reescalado);
ev_reescalado = setTimeout( function() {
dimensionesPEP = EPETBrowserDims();
}, 300)
});

if (typeof(UN) == "undefined" )
var UN = "as";

var versionMovil = document.location.pathname.indexOf("/m/") == 0;

if (typeof(url_cache) == "undefined" )
var url_cache = protocolUrl + "//as02.epimg.net";
if (typeof(url_cache_siguientes) == "undefined" )
var url_cache_siguientes = protocolUrl + "//as02.epimg.net";
if (typeof(css_multimedia) == "undefined" )
var css_multimedia = protocolUrl + "//as00.epimg.net/css/v1.x/v1.2/secciones/multimedia/player.css";
if (typeof(css_multimedia_movil) == "undefined" )
var css_multimedia_movil = protocolUrl + "//as00.epimg.net/css/v1.x/v1.2/secciones/multimedia/player-movil.css";
if (typeof(url_reproductor_epet) == "undefined" )
var url_reproductor_epet = "/reproductores/playerAS.swf";
if (typeof(url_servicioVDPEP) == "undefined" )
var url_servicioVDPEP = protocolUrl + "//as.com";
if (typeof(url_reproductor_epet_live) == "undefined" )
var url_reproductor_epet_live = "/reproductores/playerAS_live.swf";
if (typeof(UrlPublicidad) == "undefined"){
if(versionMovil || (MPEP_responsive && dimensionesPEP.ancho < anchoReferenciaMobile))
var UrlPublicidad = protocolUrl + "//pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=%2F7811748%2Fas_mob%2Fplayer_video%2Fflash&ciu_szs=&impl=s&gdfp_req=1&env=vp&output=vast&correlator={random}&unviewed_position_start=1&description_url=[description_url]";
else
var UrlPublicidad = protocolUrl + "//pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=%2F7811748%2Fas_web%2Fplayer_video%2Fflash&ciu_szs=&impl=s&gdfp_req=1&env=vp&output=vast&correlator={random}&unviewed_position_start=1&description_url=[description_url]";
}
if (typeof(UrlPublicidadOveron) == "undefined"){
if(versionMovil || (MPEP_responsive && dimensionesPEP.ancho < anchoReferenciaMobile))
var UrlPublicidadOveron = protocolUrl + "//pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=%2F7811748%2Foveron_player%2Fas_mob%2Fflash&ciu_szs=&impl=s&gdfp_req=1&env=vp&output=vast&correlator={random}&unviewed_position_start=1&description_url=[description_url]";
else
var UrlPublicidadOveron = protocolUrl + "//pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=%2F7811748%2Foveron_player%2Fas_web%2Fflash&ciu_szs=&impl=s&gdfp_req=1&env=vp&output=vast&correlator={random}&unviewed_position_start=1&description_url=[description_url]";
}
if (typeof(postroll_HTML5) == "undefined")
var postroll_HTML5 = true;
if (typeof(publicidad_HTML5) == "undefined")
var publicidad_HTML5 = true;
if (typeof(modoSiguientesVideos) == "undefined")
var modoSiguientesVideos = 0;
if (typeof(modoSiguientesVideosTimeout) == "undefined")
var modoSiguientesVideosTimeout = 5;
if (typeof(modoSiguientesVideosSinSalto) == "undefined")
var modoSiguientesVideosSinSalto = 0;
if (typeof(controlesNativosAudio) == "undefined")
var controlesNativosAudio = false;
if (typeof(controlesNativosVideo) == "undefined")
var controlesNativosVideo = false;
if (typeof(orden_busqueda_url_externa) == 'undefined')
var orden_busqueda_url_externa = ["muzu","youtube"];
var code_ima3_HTML5_cargado = "nocargado";
if (typeof(simplemediaplayer_mediateca_PEP) == "undefined" )
var simplemediaplayer_mediateca_PEP = "//as.player-top.prisasd.com//psdmedia/media/simple/js/SimpleMediaPlayer.min.js";
if (typeof(id_player_mediateca_PEP) == "undefined" )
var id_player_mediateca_PEP = "162";
if (typeof(id_cuenta_mediateca_PEP) == "undefined" )
var id_cuenta_mediateca_PEP = "diarioas";
var mediateca = [];
var PSDss = document.createElement("script");
PSDss.type= 'text/javascript';
PSDss.src = simplemediaplayer_mediateca_PEP;
document.getElementsByTagName('head')[0].appendChild(PSDss);
function arreglaUrl(url)
{
var result;
if (!url.match(/youtu/i))
{
if (url.match(/muzu/i))
url = url.replace("/a/","/i/");
else if(url.match(/vimeo/i)){
if(url.match(/player/i)){
return url;
}else{
var reg = /\/\d*$/;
var idVimeo = reg.exec(url);
if(idVimeo[0]) return "//player.vimeo.com/video"+idVimeo[0];
}
}
return url;
}
else
{
var esYT = /youtube.*\/embed\//i;
if (!esYT.test(url))
{
var reg = /([^\/]*\/\/[^\/]*youtube[^\/]*)\/.*v=([^&]+)/i;
result = reg.exec(url);
if (result)
{
return result[1] + "/embed/" + result[2];
}
else
{
var esYTCorta = /http:\/\/youtu\.be\/([^\?\/]+)/
result = esYTCorta.exec(url);
if (result)
return protocolUrl + "//www.youtube.com/embed/" + result[1];
}
}
return url;
}
}
if (typeof(eligeUrlenlace) == 'undefined')
{
function eligeUrlenlace(arrayUrls)
{
var n = arrayUrls.length;
if (n == 0)
return "";
if (n == 1)
return arreglaUrl(arrayUrls[0]);
var re;
var regexp;
var cadena_urls;
var result;
cadena_urls = "||" + arrayUrls.join("||") + "||";
for (i=0; i< orden_busqueda_url_externa.length; i++)
{
re = "/" + "\\|\\|([^\\/]*\\/\\/[^\\/]*" + orden_busqueda_url_externa[i] + "[^\\/]*\\/?[^\\|\\|]*)\\|\\|" + "/";
regexp = new RegExp(eval(re));
result = regexp.exec(cadena_urls);
if (result)
{
return arreglaUrl(result[1]);
}
}
return arreglaUrl(arrayUrls[0]);
}
}
var PAGE_TITLE = (document.getElementsByTagName('title')[0] ) ? document.getElementsByTagName('title')[0].innerHTML.replace(/'|"|\|/g, "") : "sin título";
var supportsOrientationChange = "onorientationchange" in window;
var orientationEvent = supportsOrientationChange ? "orientationchange" : "resize";
var connectionPEP = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
var FlashDetect = new function(){
var self = this;
self.release = "1.0.2";
self.installed = false;
self.major = -1;
self.minor = -1;
self.revision = -1;
self.revisionStr = "";
self.activeXVersion = "";
var activeXDetectRules = [
{
"name":"ShockwaveFlash.ShockwaveFlash.7",
"version":function(obj){
return getActiveXVersion(obj);
}
},
{
"name":"ShockwaveFlash.ShockwaveFlash.6",
"version":function(obj){
var version = "6,0,21";
try{
obj.AllowScriptAccess = "always";
version = getActiveXVersion(obj);
}catch(err){}
return version;
}
},
{
"name":"ShockwaveFlash.ShockwaveFlash",
"version":function(obj){
return getActiveXVersion(obj);
}
}
];
var getActiveXVersion = function(activeXObj){
var version = -1;
try{
version = activeXObj.GetVariable("$version");
}catch(err){}
return version;
};
var getActiveXObject = function(name){
var obj = -1;
try{
obj = new ActiveXObject(name);
}catch(err){}
return obj;
};
var parseActiveXVersion = function(str){
var versionArray = str.split(",");
return {
"major":parseInt(versionArray[0].split(" ")[1], 10),
"minor":parseInt(versionArray[1], 10),
"revision":parseInt(versionArray[2], 10),
"revisionStr":versionArray[2]
};
};
var parseRevisionStrToInt = function(str){
return parseInt(str.replace(/[a-zA-Z]/g, ""), 10) || self.revision;
};
self.majorAtLeast = function(version){
return self.major >= version;
};
self.FlashDetect = function(){
if(navigator.plugins && navigator.plugins.length>0){
var type = 'application/x-shockwave-flash';
var mimeTypes = navigator.mimeTypes;
if(mimeTypes && mimeTypes[type] && mimeTypes[type].enabledPlugin && mimeTypes[type].enabledPlugin.description){
var desc = mimeTypes[type].enabledPlugin.description;
var descParts = desc.split(' ');
var majorMinor = descParts[2].split('.');
self.major = parseInt(majorMinor[0], 10);
self.minor = parseInt(majorMinor[1], 10);
self.revisionStr = descParts[3];
self.revision = parseRevisionStrToInt(self.revisionStr);
self.installed = true;
}
}else if(navigator.appVersion.indexOf("Mac")==-1 && window.execScript){
var version = -1;
for(var i=0; i<activeXDetectRules.length && version==-1; i++){
var obj = getActiveXObject(activeXDetectRules[i].name);
if(typeof obj == "object"){
self.installed = true;
version = activeXDetectRules[i].version(obj);
if(version!=-1){
var versionObj = parseActiveXVersion(version);
self.major = versionObj.major;
self.minor = versionObj.minor;
self.revision = versionObj.revision;
self.revisionStr = versionObj.revisionStr;
self.activeXVersion = version;
}
}
}
}
}();
};
var versionFlash = FlashDetect.major;
var revisionFlash = FlashDetect.revisionStr;
var subVersionFlash = revisionFlash.replace(/[^\d]+/g, "");
function EPET_FlashHTML(minVersion, source, width, height, op, id){
var self = this;
var baseElement = document.createElement("div");
var options = arguments[4] || {};
var winIE = ((navigator.appVersion.toLowerCase().indexOf("win")!=-1) && (navigator.appName=="Microsoft Internet Explorer"));
var idCount = EPET_FlashHTML.idCount++;
var namespaceAdded = false;
var namespaceName = "flashtml";
var namespaceURN = protocolUrl + "//www.featureblend.com/2007/flashtml/";
if (typeof(id) == "undefined" )
var id = "objetoFlash" + String(Math.random()).substr(2,9);
var idObjeto = id;
self.domTemplate = "";
self.innerHTML = "";
self.xhtml = "";
self.inDocumentElement = "";
var getCabVersion = function(minVersion){
return minVersion + ",0,0,0";
};
var getNameValueAttrFromOptions = function(name){
return (typeof options[name] != "undefined")?getNameValueAttributes(name, options[name].toString()):"";
};
var getNameValueAttributes = function(name, value){
return {
"@name":name,
"@value":value
};
};
var createElementFromRule = function(name, target){
var newElement = safeCreateElement(name.replace("#",""));
return target.appendChild(newElement);
};
var getID = function(){
if (idObjeto != undefined && idObjeto != "")
return idObjeto;
var patron = /.*\/([\w-]+)\.swf\??/i;
if (patron.test(source))
{
return (RegExp.$1);
}
return "ObjetoSWF";
};
var setAttributeFromRule = function(name, value, target){
target.setAttribute(name.replace("@",""), value);
};
var safeCreateElement = function(name){
if((name=="object" || name=="param") && document.namespaces){
if(!namespaceAdded){
document.namespaces.add(namespaceName, namespaceURN);
namespaceAdded = true;
}
return document.createElement(namespaceName + ":" + name);
}else{
return document.createElement(name);
}
};
var htmlTidy = function(str){
str = str.replace(/<\?xml([^>]*)>/, "");
str = str.replace(eval("/"+namespaceName+":/g"),"");
str = str.replace(/><\/param>/g,">");
str = str.replace(/(<param )(.*?)(>)/g, "<param $2 \/>");
return str;
};
var parseRules = function(position, target){
for(var i in position){
if(i.charAt(0)=="#"){
var appendedElement;
if(typeof position[i] == "object" && position[i].length){
for(var j=0; j<position[i].length; j++){
if(position[i][j]()!==""){
appendedElement = createElementFromRule(i, target);
parseRules(position[i][j](), appendedElement);
}
}
}else if(typeof position[i]=="function" && position[i]()!==""){
appendedElement = createElementFromRule(i, target);
parseRules(position[i](), appendedElement);
}
}else if(i.charAt(0)=="@"){
if(typeof position[i]=="function" && position[i]()!==""){
setAttributeFromRule(i, position[i](), target);
}else if(typeof position[i] == "string"){
setAttributeFromRule(i, position[i], target);
}
}
}
};
var structuralRules = {
"#object":function(){
return {
"@type":function(){
return (!winIE)?"application/x-shockwave-flash":"";
},
"@codebase":function(){
return (winIE)?protocolUrl + "//fpdownload.macromedia.com/get/flashplayer/current/swflash.cab#version="+getCabVersion(minVersion):"";
},
"@classid":function(){
return (winIE)?"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000":"";
},
"@data":function(){
return (!winIE)?source:"";
},
"@width":function(){
return width.toString();
},
"@height":function(){
return height.toString();
},
"@id":function(){
return getID();
},
"@tabindex":function(){
return options.tabindex || "";
},
"#param":[
function(){
return (winIE)?getNameValueAttributes("movie", source):"";
},
function(){
return getNameValueAttrFromOptions("allowscriptaccess");
},
function(){
return getNameValueAttrFromOptions("allowfullscreen");
},
function(){
return getNameValueAttrFromOptions("swliveconnect");
},
function(){
return getNameValueAttrFromOptions("play");
},
function(){
return getNameValueAttrFromOptions("loop");
},
function(){
return getNameValueAttrFromOptions("menu");
},
function(){
return getNameValueAttrFromOptions("quality");
},
function(){
return getNameValueAttrFromOptions("scale");
},
function(){
return getNameValueAttrFromOptions("align");
},
function(){
return getNameValueAttrFromOptions("salign");
},
function(){
return getNameValueAttrFromOptions("wmode");
},
function(){
return getNameValueAttrFromOptions("bgcolor");
},
function(){
return getNameValueAttrFromOptions("base");
},
function(){
var result = "";
if(options.flashvars){
var flashVarsStr = (typeof options.flashvars == "object")?EPET_FlashHTML.getQueryStrFromObj(options.flashvars):options.flashvars;
result = getNameValueAttributes("flashvars", flashVarsStr);
}
return result;
}
]
};
}
};
self.append = function(target){
return addToElement(target, false);
};
self.replace = function(target){
return addToElement(target, true);
};
var addToElement = function(target, replace){
var result = false;
var targetObj = (typeof target=="object")?target:document.getElementById(target);
if(!self.inDocumentElement){
if(winIE){
if(replace){
targetObj.innerHTML = self.xhtml;
}else{
targetObj.innerHTML += self.xhtml;
}
self.inDocumentElement = document.getElementById(getID());
window.attachEvent("onunload", self.garbageCollection);
}else{
if(replace){
while (targetObj.firstChild) {
targetObj.removeChild(targetObj.firstChild);
}
}
self.inDocumentElement = targetObj.appendChild(baseElement.childNodes[0]);
}
result = self.inDocumentElement;
}
return result;
};
self.garbageCollection = function(){
if(winIE && self.inDocumentElement){
self.inDocumentElement = null;
}
};
self.EPET_FlashHTML = function(){
parseRules(structuralRules, baseElement);
self.domTemplate = baseElement.childNodes[0];
self.innerHTML = baseElement.innerHTML;
self.xhtml = htmlTidy(self.innerHTML);
}();
self.writeHTML = function(){
document.write(self.xhtml);
};
}
EPET_FlashHTML.getQueryStrFromObj = function(nameValue){
var str = "";
for(var i in nameValue){
if(nameValue.hasOwnProperty(i)){
str += (encodeURI(i) + "=" + encodeURI(nameValue[i]) + "&");
}
}
return str.substring(0, str.length-1);
};
EPET_FlashHTML.idCount = 0;
EPET_FlashHTML.idPattern = "EPET_FlashHTML_";
EPET_FlashHTML.release = "1.0.1";
function EPET_Grafico_Flash(grafico, GF_version, GF_params, flash_params, GF_width, GF_height, img_altenativa, url_alternativa, texto_alt, idDivContenedor, idObjectFlash)
{
var id_div_Graficoflash;
if (typeof(idDivContenedor) == "undefined" )
{
id_div_Graficoflash =  "div_GraficoFlash_" + String(Math.random()).substr(2,9);
document.write('<div id="' + id_div_Graficoflash + '"></div>');
}
else
id_div_Graficoflash = idDivContenedor;
if (versionFlash >= GF_version)
{
var params = {"menu":"false", "wmode":"window" };
for(var key in flash_params)
{
params[key] = flash_params[key];
}
var cadena_params = "";
for(var key in GF_params)
{
cadena_params += encodeURIComponent(key) + "=" + encodeURIComponent(GF_params[key]) + "&";
}
if (cadena_params.length > 0)
grafico = grafico + "?" + cadena_params.substr(0,cadena_params.length-1);
var objeto_grafico = new EPET_FlashHTML(GF_version, grafico, GF_width, GF_height, params , idObjectFlash);
objeto_grafico.replace(id_div_Graficoflash);
}
else
{
if (img_altenativa != "")
{
document.getElementById(id_div_Graficoflash).innerHTML = "<a href=\"" + url_alternativa + "\" target=\"_blank\" ><img src=\"" + img_altenativa + "\" width=\"" + GF_width + "\" height=\"" + GF_height + "\" border=\"0\"  alt=\"" + texto_alt + "\" /></a>\n";
}
}
}
function marcadoEventos(obj)
{
if (!obj.datos.myStreamingTag || typeof(as_omn_f_iniciaMarcadoComscore) == "undefined" || typeof(as_omn_f_paraMarcadoComscore) == "undefined")
return;
switch (obj.evento){
case "adStart": case "mediaBegin":
case "adResumed": case "mediaResumed":
if (obj.evento == "adStart" || obj.evento == "adResumed")
obj.datos.time = obj.datos.adCurrentTime ? obj.datos.adCurrentTime : 0;
else
obj.datos.time = obj.datos.currentTime ? obj.datos.currentTime : 0;
as_omn_f_iniciaMarcadoComscore(obj);
obj.datos.estadoComscore = obj.evento;
break;
case "adComplete": case "mediaComplete":
case "adPaused": case "adSkip": case "mediaPaused":
if (obj.datos.estadoComscore == "adPaused" || obj.datos.estadoComscore == "mediaPaused" )
return;
if (obj.evento == "adComplete" || obj.evento == "adPaused" || obj.evento == "adSkip")
obj.datos.time = obj.datos.adCurrentTime ? obj.datos.adCurrentTime : 0;
else
obj.datos.time = obj.datos.currentTime ? obj.datos.currentTime : 0;
as_omn_f_paraMarcadoComscore(obj);
obj.datos.estadoComscore = obj.evento;
break;
default:
break;
}
}
var EPET_Marcado_Multimedia = function(datosMarcado)
{
this._datosMarcado = datosMarcado;
this.eventos = {};
this._datosMarcado.estadoComscore = "";
var evars = '70|8|2|74|42|67|24|18|19|75';
this.marcaEvento = function(evento)
{
var event = "";
var key = evento;
switch (evento)
{
case "adStart" :
event = "event13";
key = evento + " _" + this._datosMarcado.adCue;
marcadoEventos({"datos":this._datosMarcado,"evento": evento});
break;
case "adComplete" :
event = "event14";
key = evento + " _" + this._datosMarcado.adCue;
marcadoEventos({"datos":this._datosMarcado,"evento": evento});
break;
case "adSkip" :
event = "event15";
key = evento + " _" + this._datosMarcado.adCue;
marcadoEventos({"datos":this._datosMarcado,"evento": evento});
break;
case "adError" :
event = "event18";
key = evento + " _" + this._datosMarcado.adCue;
break;
case "mediaBegin" :
event = "event11";
marcadoEventos({"datos":this._datosMarcado,"evento": evento});
break;
case "mediaComplete" :
event = "event12";
marcadoEventos({"datos":this._datosMarcado,"evento": evento});
break;
case "halfmediaComplete" :
event = "event79";
break;

case "adPaused" :
case "mediaPaused" :
marcadoEventos({"datos":this._datosMarcado,"evento": evento});
break;
case "adResumed" :
marcadoEventos({"datos":this._datosMarcado,"evento": evento});
break;
case "mediaResumed" :
marcadoEventos({"datos":this._datosMarcado,"evento": evento});
break;
default :
break;
}
if (this.eventos[key])
return;
this.eventos[key] = 1;
if (event != "")
{
var evars_value = this._datosMarcado.media + "|" + this._datosMarcado.titulo.replace(/'|"|\|/g, "") + " - " + this._datosMarcado.referencia + "|" + (this._datosMarcado.playerName ? this._datosMarcado.playerName.replace(/'|"|\|/g, ""):"") + "|" + Math.floor(this._datosMarcado.duracion) + "|" + this._datosMarcado.tipoReproduccion + "|" + this._datosMarcado.publicidad + (this._datosMarcado.ad != "" ? " " + this._datosMarcado.ad : "" ) + "|" + this._datosMarcado.adCue + "|prisa|diarioas|" + this._datosMarcado.agrs_video;
var newevars = evars;
if (typeof(this._datosMarcado.adTitle) != "undefined" && this._datosMarcado.adTitle != "")
{
newevars = newevars + "|9";
evars_value += "|" + this._datosMarcado.adTitle;
}
if (typeof(this._datosMarcado.posSiguientesVideos) != "undefined")
{
newevars = newevars + "|76";
evars_value += "|" + this._datosMarcado.posSiguientesVideos;
}
if (typeof(this._datosMarcado.uid) != "undefined" && this._datosMarcado.uid != "")
{
newevars = newevars + "|38";
evars_value += "|" + this._datosMarcado.uid;
}
newevars = newevars + "|25";
evars_value += "|" + (this._datosMarcado.fuente ? this._datosMarcado.fuente : "propio");
if (typeof(this._datosMarcado.seccion_creacion) != "undefined" && this._datosMarcado.seccion_creacion != "")
{
newevars = newevars + "|77";
evars_value += "|" + this._datosMarcado.seccion_creacion;
}
if (typeof(this._datosMarcado.modoReproduccion) != "undefined" && this._datosMarcado.modoReproduccion != "")
{
newevars = newevars + "|26";
evars_value += "|" + this._datosMarcado.modoReproduccion;
}
if (typeof(launchAjaxOMN) == "function")
launchAjaxOMN(newevars, evars_value, event,this._datosMarcado.tags, this._datosMarcado.autores);
}
}
this.marcaComscore = function(evento)
{
if (evento == "play" && typeof(this.eventos["mediaBegin"]) != "undefined")
{
marcadoEventos({"datos":this._datosMarcado,"evento": "mediaResumed"});
}
else
if (evento == "adPaused" || evento == "pause")
{
marcadoEventos({"datos":this._datosMarcado,"evento": evento == "adPaused" ? "adPaused" : "mediaPaused"});
}
else
if (evento == "adResumed" )
{
marcadoEventos({"datos":this._datosMarcado,"evento": evento});
}
}
}
function marcadoReproductorMultimedia(datos)
{
var objetoVideo = MultimediaPEP[datos.id].multimedia;
datos.uid = objetoVideo.uid();
datos.seccion_creacion = objetoVideo.seccion_creacion();
datos.fuente = objetoVideo.fuente();
datos.tags = objetoVideo.tags();
datos.autores = objetoVideo.autores();
objetoVideo.marcado(datos);
}
var videoFlash =  versionFlash > 10 || (versionFlash == 10 && FlashDetect.minor >= 2);
if (dispositivoMovil && (userAgent.indexOf("firefox") > -1 || userAgent.indexOf("android 2") > -1))
publicidad_HTML5 = false;
var reproduciendo = false;
var MultimediaActual = "";
var MultimediaPEP = {};
var id_pidiendoDatos  = "";
var contadorMultimedia = 0;
function soporteVideo()
{
var v=document.createElement('video');
return typeof(v.canPlayType) != "undefined" && (!!v.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"').replace(/no/,'') || !!v.canPlayType( 'video/mp4; codecs="avc1.42E01E"').replace(/no/,''));
}
var canPlayMP4 = soporteVideo();
function EPETaddEvent (element, evento, func) {
if (document.addEventListener){
element.addEventListener(evento, func, false);
} else {
element.attachEvent('on'+evento, func);
}
}
function EPETremoveEvent(element, evento, func)
{
if (document.removeEventListener)
element.removeEventListener(evento, func)
else
if (document.detachEvent)
element.detachEvent('on'+evento, func);
}
function EPET_setScrollPosition(val)
{
if (document.documentElement.scrollTop)
document.documentElement.scrollTop  = val
else
window.scrollTo(0,val);
}
function EPET_calculaTopPosition(obj)
{
var curTop = 0;
if (obj.offsetParent) {
do {
curTop += obj.offsetTop;
} while (obj = obj.offsetParent);
}
return curTop;
}
function VideoReproduciendo(id, play)
{
MultimediaReproduciendo(id, play)
}
function MultimediaReproduciendo(id, play)
{
if ( MultimediaActual != "" && id != MultimediaActual)
{
MultimediaPEP[MultimediaActual].multimedia.pause();
var datos;
var newid = MultimediaPEP[MultimediaActual].id;
if (MultimediaPEP[MultimediaActual].modoSiguientesVideos == 0)
{
datos = MultimediaPEP[MultimediaActual].datos;
datos.autoplay = false;
delete MultimediaPEP[MultimediaActual];
setTimeout(function(){
document.getElementById(newid).innerHTML = "";
EPET_VideoPlayer(datos, newid);
},500);
}
else {
if (MultimediaPEP[MultimediaActual].id != MultimediaPEP[id].id) {
resetSiguientesVideos();
clearTimeout(SiguientesVideosPEP.cuenta_atras);
datos = JSON.parse(JSON.stringify(MultimediaPEP_originales[MultimediaPEP[MultimediaActual].id]));
document.getElementById(MultimediaPEP[MultimediaActual].id).style.paddingTop = '0px';
document.getElementById(MultimediaPEP[MultimediaActual].id).style.marginLeft = '0px';
delete MultimediaPEP[MultimediaActual];
datos.autoplay = false;
setTimeout(function(){
document.getElementById(newid).innerHTML = "";
var video = new EPET_Video(datos, newid);
},500);
}
}
if(versionMovil || MPEP_article){
document.getElementById(newid).style.height = 'auto';
document.getElementById(newid).parentNode.style.height = 'auto';
}
MultimediaActual = id;
MultimediaPEP[MultimediaActual].multimedia.changeOrientation();
if (play)
setTimeout(function() {	MultimediaPEP[id].multimedia.play();}, 300);
}else
MultimediaActual = id;
}
function MultimediaReinicio(id)
{
MultimediaPEP[id].multimedia.resetMarcado(id);
}
function reseteaVideo(datosVideo, id_div_ReproductorVideo,id)
{
MultimediaPEP[id].multimedia.stop();
}
var MultimediaPEP_originales = {};
var SiguientesVideosPEP = {};
SiguientesVideosPEP.dataSources = {};
SiguientesVideosPEP.source_active = "";
SiguientesVideosPEP.ref_active = "";
SiguientesVideosPEP.id_ref_active = "";
SiguientesVideosPEP.videoWallData = null;
SiguientesVideosPEP.videoWall_primera_vez = false;
SiguientesVideosPEP._id = "";
SiguientesVideosPEP._datos = "";
SiguientesVideosPEP.cuenta_atras = null;
SiguientesVideosPEP.cuenta_atras_error = null;
SiguientesVideosPEP.segundos = modoSiguientesVideosTimeout;
SiguientesVideosPEP.videoWall_w = 640;
SiguientesVideosPEP.videoWall_h = 360;
SiguientesVideosPEP.keyword_primero = "user_initiated";
SiguientesVideosPEP.keyword_siguientes = "auto_initiated";
SiguientesVideosPEP.paraBorrar = [];
SiguientesVideosPEP.template = '<div style="height:100%"><div class="MPEP-prox-video #min#">'+
'<div class="MPEP-inner">'+
'<div class="MPEP-prox-btn-ctrl">'+
'<span><a class="MPEP-prox-btn-ant" href="javascript:void(0)" onclick="javascript:volver_a_ver()">Volver a ver</a></span>'+
'<span><a class="MPEP-prox-btn-sig" href="javascript:void(0)" onclick="javascript:recarga_siguiente_video()">Siguiente</a></span>'+
'</div>'+
'<span class="MPEP-prox-cont">Siguiente vídeo en <strong id="siguientes_contador">5</strong> segundos</span>'+
'<div class="MPEP-prox-video-media"><a href="javascript:void(0)" onclick="javascript:cargaVideo(false,\'organico\')"><img class="MPEP-prox-video-img" src="#foto#" alt="" #estilo# /></a></div>'+
'<div class="MPEP-prox-video-txt">'+
'<div class="MPEP-prox-tit"><a href="javascript:void(0)" onclick="javascript:cargaVideo(false,\'organico\')">#titulo#</a></div>'+
'</div>'+
'</div>'+
'</div></div>';
SiguientesVideosPEP.video = "";
SiguientesVideosPEP.primeraVez = false;
function siguientesVideos(fuente, referencia)
{
var id_contenedor = MultimediaPEP[referencia].id;
SiguientesVideosPEP.source_active = fuente;
SiguientesVideosPEP.ref_active = referencia;
SiguientesVideosPEP.id_ref_active = id_contenedor;
SiguientesVideosPEP.primeraVez = false;
if (typeof(SiguientesVideosPEP.dataSources[fuente]) != "undefined")
{
videosSiguientes_callback(SiguientesVideosPEP.dataSources[fuente].datos);
}
else
{
var head = document.getElementsByTagName("head")[0];
var script = document.createElement("script");
script.type = "text/javascript";
script.src = protocolUrl + "//as02.epimg.net/rss/tags/continuo/agr_" + fuente + ".js2";
head.appendChild(script);
SiguientesVideosPEP.primeraVez = true;
}
}
function barajaArray(ref) {
var salida = new Array;
var copia = JSON.parse(JSON.stringify(ref));
while (copia.length > 0)
{
salida.push(copia.splice(Math.floor(Math.random() * copia.length),1)[0]);
}
return salida;
}
function videosSiguientes_callback(datos)
{
if (!SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active])
{
SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active] = {};
SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active].datos = datos;
}
if (SiguientesVideosPEP.videoWallData == null)
{
if (SiguientesVideosPEP.primeraVez)
SiguientesVideosPEP.videoWallData = JSON.parse(JSON.stringify(SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active].datos));
else
SiguientesVideosPEP.videoWallData = barajaArray(SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active].datos);
SiguientesVideosPEP.videoWallData.unshift(JSON.parse(JSON.stringify(MultimediaPEP_originales[SiguientesVideosPEP.id_ref_active])));
if(versionMovil || MPEP_article){
var caja = document.getElementById(MultimediaPEP[SiguientesVideosPEP.ref_active].id).parentNode;
caja.style.width = MultimediaPEP[SiguientesVideosPEP.ref_active].datos.anchoPlayer + "px";
caja.style.height = MultimediaPEP[SiguientesVideosPEP.ref_active].datos.altoPlayer + "px";
caja.style.backgroundColor = "#000";
caja.style.position = "relative";
}
}
if (!SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active][SiguientesVideosPEP.id_ref_active])
{
SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active][SiguientesVideosPEP.id_ref_active] = {};
SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active][SiguientesVideosPEP.id_ref_active].idx = 1;
SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active][SiguientesVideosPEP.id_ref_active].ancho = MultimediaPEP[SiguientesVideosPEP.ref_active].datos.anchoPlayer;
SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active][SiguientesVideosPEP.id_ref_active].alto = MultimediaPEP[SiguientesVideosPEP.ref_active].datos.altoPlayer;
SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active][SiguientesVideosPEP.id_ref_active].source = SiguientesVideosPEP.source_active;
}
else
{
SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active][SiguientesVideosPEP.id_ref_active].idx += 1;
}

var videoID = SiguientesVideosPEP.ref_active;
var splitVideoID = videoID.split("as-");
var findVideo = "NO";
var nextIdVideo = 0;
for (i in SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active].datos)
{
if(splitVideoID[0].localeCompare(SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active].datos[i].idRefBrightcove) == 0 ) {
findVideo = "YES";
nextIdVideo = i;
}
}


cargaSiguienteVideo(SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active], SiguientesVideosPEP.ref_active)
}
function reajustaDimensiones(cajaw, cajah, videow, videoh)
{
var salida = [0,0,0,0];
var prop1 = cajaw * videoh / videow;
if ( prop1 > cajah)
{
salida[1] = cajah;
salida[0] = Math.floor(cajah * videow / videoh);
salida[2] = Math.round((cajaw - salida[0]) / 2);
}
else
{
salida[0] = cajaw;
salida[1] = Math.floor(prop1);
salida[3] = Math.round((cajah - salida[1]) /2);
}
return salida;
}
function cargaSiguienteVideo(ref_datos, id_actual)
{
var id_video = id_actual.replace(/\-\d+$/, "");
SiguientesVideosPEP._id = MultimediaPEP[id_actual].id;
var dims;
cargaVideo = function(pause, modo) {
clearTimeout(SiguientesVideosPEP.cuenta_atras);
MultimediaActual = id_actual;
if (!dispositivoMovil && !pause)
SiguientesVideosPEP._datos.autoplay = true;
else
SiguientesVideosPEP._datos.autoplay = false;
document.getElementById(SiguientesVideosPEP._id).innerHTML = "";
document.getElementById(SiguientesVideosPEP._id).style.paddingTop = SiguientesVideosPEP._datos.top + "px";
document.getElementById(SiguientesVideosPEP._id).style.marginLeft = SiguientesVideosPEP._datos.left + "px";
if (typeof(modo) == "undefined")
SiguientesVideosPEP._datos.modoReproduccion = "secuencial";
else
SiguientesVideosPEP._datos.modoReproduccion = modo;
SiguientesVideosPEP.video = new EPET_Video(SiguientesVideosPEP._datos, SiguientesVideosPEP._id, true);
};
if (!SiguientesVideosPEP.videoWall_primera_vez)
{
SiguientesVideosPEP.videoWall_primera_vez = true;
for (var n=SiguientesVideosPEP.paraBorrar.length-1; n>=0; n--)
{
var id = SiguientesVideosPEP.paraBorrar.splice(i,1);
delete(MultimediaPEP[id[0]]);
}
for (var i = SiguientesVideosPEP.videoWallData.length - 1; i >= 0; i--)
{
if (modoSiguientesVideosSinSalto > 0 && i > 0 && (SiguientesVideosPEP.videoWallData[i].idRefBrightcove + UN) == id_video)
{
SiguientesVideosPEP.videoWallData.splice(i,1);
continue;
}
dims = reajustaDimensiones(ref_datos[SiguientesVideosPEP._id].ancho, ref_datos[SiguientesVideosPEP._id].alto, SiguientesVideosPEP.videoWallData[i].anchoPlayer, SiguientesVideosPEP.videoWallData[i].altoPlayer);
SiguientesVideosPEP.videoWallData[i].anchoPlayer = dims[0];
SiguientesVideosPEP.videoWallData[i].altoPlayer = dims[1];
SiguientesVideosPEP.videoWallData[i].anchoFotograma = dims[0];
SiguientesVideosPEP.videoWallData[i].altoFotograma = dims[1];
SiguientesVideosPEP.videoWallData[i].playerEPETParams.mediaWidth = dims[0];
SiguientesVideosPEP.videoWallData[i].playerEPETParams.mediaHeight = dims[1];
SiguientesVideosPEP.videoWallData[i].ancho_caja = ref_datos[SiguientesVideosPEP._id].ancho;
SiguientesVideosPEP.videoWallData[i].alto_caja = ref_datos[SiguientesVideosPEP._id].alto;
SiguientesVideosPEP.videoWallData[i].left = dims[2];
SiguientesVideosPEP.videoWallData[i].top = dims[3];
SiguientesVideosPEP.videoWallData[i].agrsNombreNormalizado = ref_datos[SiguientesVideosPEP._id].source;
if (i != 0) {
SiguientesVideosPEP.videoWallData[i].agrsIds = SiguientesVideosPEP.videoWallData[0].agrsIds.split(",")[0];
SiguientesVideosPEP.videoWallData[i].tagsIds = '';
SiguientesVideosPEP.videoWallData[i].tagsNombreNormalizado = '';
}
SiguientesVideosPEP.videoWallData[i].autoplay = dispositivoMovil ? false : true;
SiguientesVideosPEP.videoWallData[i].idx_siguientes_videos = i;
}
}
var idx = ref_datos[SiguientesVideosPEP._id].idx;
if (modoSiguientesVideosSinSalto > 0 && idx >= SiguientesVideosPEP.videoWallData.length)
{
clearTimeout(SiguientesVideosPEP.cuenta_atras);
SiguientesVideosPEP._datos = SiguientesVideosPEP.videoWallData[0];
cargaVideo(true);
resetSiguientesVideos();
return;
}
var cuenta = SiguientesVideosPEP.segundos;
cuentaAtras = function ()
{
if (cuenta > 0)
{
if (!document.getElementById("siguientes_contador"))
return;
document.getElementById("siguientes_contador").innerHTML = cuenta;
cuenta--;
SiguientesVideosPEP.cuenta_atras = setTimeout('cuentaAtras()',1000);
}
else
{
if (modoSiguientesVideosSinSalto > 0)
cargaVideo();
else
recarga_siguiente_video();
}
};
volver_a_ver = function()
{
clearTimeout(SiguientesVideosPEP.cuenta_atras);
if (modoSiguientesVideosSinSalto > 0) {
ref_datos[SiguientesVideosPEP._id].idx -= 1;
SiguientesVideosPEP._datos = JSON.parse(JSON.stringify(SiguientesVideosPEP.videoWallData[ref_datos[SiguientesVideosPEP._id].idx]));
} else {
SiguientesVideosPEP._datos = JSON.parse(JSON.stringify(MultimediaPEP_originales[SiguientesVideosPEP.id_ref_active]));
}
cargaVideo(false,'organico');
if (SiguientesVideosPEP.video.tipo() == "html5" && SiguientesVideosPEP._datos.autoplay)
SiguientesVideosPEP.video.play();
};
recarga_siguiente_video = function() {
window.location.replace(SiguientesVideosPEP._datos.urlNoticia+'?autoplay=1');
};
SiguientesVideosPEP._datos = JSON.parse(JSON.stringify(SiguientesVideosPEP.videoWallData[ref_datos[SiguientesVideosPEP._id].idx]));
var codigo = SiguientesVideosPEP.template.replace("#titulo#", SiguientesVideosPEP._datos.tituloVideo.replace('"',''));
codigo = codigo.replace("#foto#",SiguientesVideosPEP._datos.playerEPETParams.URLMediaStill);
codigo = codigo.replace("#ancho#",SiguientesVideosPEP._datos.ancho_caja);
codigo = codigo.replace("#alto#",SiguientesVideosPEP._datos.alto_caja);
if (SiguientesVideosPEP._datos.ancho_caja < 400)
{
codigo = codigo.replace('#estilo#',' style="display:none" ');
codigo = codigo.replace('#min#',' MPEP-prox-min ');
}
else
{
codigo = codigo.replace('#estilo#','');
codigo = codigo.replace('#min#','');
}
document.getElementById(SiguientesVideosPEP._id).style.paddingTop = "0px";
document.getElementById(SiguientesVideosPEP._id).style.marginLeft = "0px";
document.getElementById(SiguientesVideosPEP._id).innerHTML = codigo;
cuentaAtras();
}
function resetSiguientesVideos()
{
SiguientesVideosPEP.videoWallData = null;
SiguientesVideosPEP.videoWall_primera_vez = false;
if (typeof(SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active]) != "undefined" && typeof(SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active][SiguientesVideosPEP.id_ref_active]) != "undefined")
delete(SiguientesVideosPEP.dataSources[SiguientesVideosPEP.source_active][SiguientesVideosPEP.id_ref_active]);
}
function EPET_PlayerRetransmisionDirecto(datosTransmision, id_divContenedor, estado)
{
url_reproductor_epet = url_reproductor_epet_live;
var id_div_ReproductorVideo;
if (typeof(id_divContenedor) == "undefined" )
{
id_div_ReproductorVideo = "VideoPlayer_Directo_" + String(Math.random()).substr(2,9);
document.write('<div id="' + id_div_ReproductorVideo + '"></div>');
}
else
id_div_ReproductorVideo = id_divContenedor;
if (typeof(estado) == "undefined" || estado == "" || estado == 0)
estado = "0";
var texto_error = "";
switch(String(estado))
{
case "1":
texto_error =  LANG_MSG[LANG].trans_no_comenzado;
break;
case "2":
texto_error = LANG_MSG[LANG].trans_reanudara;
break;
case "3":
texto_error =  LANG_MSG[LANG].trans_finalizada;
break;
default:
texto_error = "";
}
if (texto_error != "")
{
var an = datosTransmision.ancho;
var al = datosTransmision.alto;
if ( !css_multimedia_cargado)
{
css_multimedia_cargado = true;
loadCSS(css_multimedia,null)
}
if (versionMovil || MPEP_responsive)
{
an = "100%";
al = "auto";
}
document.getElementById(id_div_ReproductorVideo).onclick = null;
document.getElementById(id_div_ReproductorVideo).innerHTML = '<div class="video_previa video_no_disponible"><div class="fondo_mensaje_video" ><span>' + texto_error +
'</span></div><img src="' + datosTransmision.caratula + '" width="' +  an + '" height="' + al + '"/></div>';
}
else
{
datosVideo = {};
datosVideo.playerEPETParams = {"mediaWidth":datosTransmision.ancho, "mediaHeight":datosTransmision.alto, "URLMediaFile":"", "URLMediaStill":datosTransmision.caratula, "URLFirstFrame":"", "compactMode": 'false'};
datosVideo.anchoPlayer = datosTransmision.ancho;
datosVideo.altoPlayer = datosTransmision.alto;
datosVideo.anchoFotograma = datosTransmision.anchoFotograma;
datosVideo.altoFotograma = datosTransmision.altoFotograma;
datosVideo.idRefBrightcove = datosTransmision.refRetransmisionBC;
datosVideo.publiActiva = datosTransmision.publicidad;
datosVideo.keywordsVideo = datosTransmision.keywords;
if (datosTransmision.refRetransmisionBC.indexOf("akamai") > -1 || datosTransmision.refRetransmisionBC.indexOf("level3") > -1)
{
if (datosVideo.keywordsVideo == "")
datosVideo.keywordsVideo = "overon_stream";
else
datosVideo.keywordsVideo += ",overon_stream";
}
datosVideo.urlNoticia = document.location.href;
datosVideo.tituloVideo = PAGE_TITLE;
datosVideo.tipoReproduccion = "streaming";
datosVideo.m3u8 = datosTransmision.transmision_m3u8 ? datosTransmision.transmision_m3u8 : "";
modoSiguientesVideos = 0;
if (typeof(datosTransmision.autoplay) != "undefined")
datosVideo.autoplay = datosTransmision.autoplay;
var video = new EPET_Video(datosVideo, id_div_ReproductorVideo);
}
}
var CACHE_VDPEP={};
function pideDatosVideo(id_video)
{
id_pidiendoDatos = id_video;
var id_servidor = id_video.replace(/\-\d+$/, "");
if (typeof(CACHE_VDPEP[id_servidor]) != "undefined")
{
EPET_VideoPlayer_callback(CACHE_VDPEP[id_servidor]);
return;
}
var url = url_servicioVDPEP + "/vdpep/1/?pepid=";
var head = document.getElementsByTagName("head")[0];
if (!MultimediaPEP[id_video])
MultimediaPEP[id_video] = new Object;
if( MultimediaPEP[id_video].script){
head.removeChild(MultimediaPEP[id_video].script);
}
MultimediaPEP[id_video].script = document.createElement("script");
MultimediaPEP[id_video].script.type = "text/javascript";
MultimediaPEP[id_video].script.src = url + id_servidor;
head.appendChild(MultimediaPEP[id_video].script);
}
function EPET_VideoPlayer_callback(datos)
{
var id_servidor = id_pidiendoDatos.replace(/\-\d+$/, "");
if (typeof(CACHE_VDPEP[id_servidor]) == "undefined")
{
CACHE_VDPEP[id_servidor] = datos;
}
MultimediaPEP[id_pidiendoDatos].multimedia.cargaDatos(datos);
}
function EPET_VideoPlayer (datosVideo, idDivContenedor)
{
var id_div_ReproductorVideo;
if (typeof(idDivContenedor) == "undefined" )
{
id_div_ReproductorVideo = "VideoPlayer_" + String(Math.random()).substr(2,9);
document.write('<div class="MPEP-prox-video" id="' + id_div_ReproductorVideo + '"></div>');
}
else
id_div_ReproductorVideo = idDivContenedor;
var video = new EPET_Video(datosVideo, id_div_ReproductorVideo);
}
function Mediateca_VideoPlayer(datosVideo, divMultimedia){
var id_div_ReproductorMultimedia;
if (typeof(divMultimedia) == "undefined" )
{
id_div_ReproductorMultimedia = "multimediaPlayer_" + String(Math.random()).substr(2,9);
document.write('<div id="' + id_div_ReproductorMultimedia + '" style="width:100%;z-index:2;"></div>');
}
else
id_div_ReproductorMultimedia = divMultimedia;
if (typeof(datosVideo.urls) == "undefined")
datosVideo.urls = [];
if (document.location.href.indexOf("autoplay=1") > -1 && !reproduciendo)
{
reproduciendo = true;
datosVideo.autoplay = true;
setTimeout(function(){
var posVideo = EPET_calculaTopPosition(document.getElementById(id_div_ReproductorMultimedia));
if (posVideo > dimensionesPEP.alto)
EPET_setScrollPosition(parseInt(posVideo));
if (typeof(window.lzld) == 'function')
{
setTimeout(function(){
var posVideo = EPET_calculaTopPosition(document.getElementById(id_div_ReproductorMultimedia));
EPET_setScrollPosition(parseInt(posVideo));
},1000);
}
},600);
}
else
{
if (typeof(datosVideo.autoplay) == "undefined")
datosVideo.autoplay = false;
}
var keywords = "";
if (datosVideo.tagsNombreNormalizado != undefined && datosVideo.tagsNombreNormalizado != "")
keywords = datosVideo.tagsNombreNormalizado;
else
if (typeof(listado_norm_tags) != "undefined" && listado_norm_tags != "")
keywords = listado_norm_tags;
if (datosVideo.keywordsVideo != undefined && datosVideo.keywordsVideo != "")
{
if (keywords != "")
keywords += "," + datosVideo.keywordsVideo;
else
keywords = datosVideo.keywordsVideo;
}
if (datosVideo.agrsNombreNormalizado != undefined && datosVideo.agrsNombreNormalizado != "")
{
if (keywords != "")
keywords += "," + datosVideo.agrsNombreNormalizado;
else
keywords = datosVideo.agrsNombreNormalizado;
}
var regexpNoticia = /http.?:\/\/([^\/]*)\/([^\/]*)\/(\d+)\/(\d+)\/(\d+)\/([^\/]*)\/.*\.html/i;
if (typeof(datosVideo.urlNoticia) == "undefined" || regexpNoticia.exec(document.location.href))
datosVideo.urlNoticia = "";
else
datosVideo.urlNoticia = datosVideo.urlNoticia + "?autoplay=1";
if (typeof(datosVideo.caratula) == "undefined")
datosVideo.caratula = "";
if (typeof(datosVideo.publiActiva) == "undefined")
datosVideo.publiActiva = false;
if (typeof(datosVideo.keywordsVideo) == "undefined")
datosVideo.keywordsVideo = "";
var datosTOP = {
"id_container": id_div_ReproductorMultimedia,
"id_cuenta": id_cuenta_mediateca_PEP,
"id_player": id_player_mediateca_PEP,
"id_media": datosVideo.id_multimedia,
"media_type": "video",
"keywords": datosVideo.keywordsVideo,
"topPlayer":{
"media" : {
"autoplay": datosVideo.autoplay,
"ancho": datosVideo.anchoPlayer,
"alto": datosVideo.altoPlayer
},
"ad": {
"enabled": datosVideo.publiActiva,
"tags_noticia": keywords
}
},
"dev" : false
};

if(datosVideo.canales_playlist){
datosTOP.playList={
"URL_list":"//gapi.prisasd.com/api/v1/search/diarioas/video/tags?tags=mn(idref|"+datosVideo.id_multimedia+")m("+datosVideo.canales_playlist+")&orderBy=modify_at|desc&size=20&itemIdref="+datosVideo.id_multimedia,
"playListSkin" : "vacia", 
"autoNext":true,
"nextpanel": {"active": true, "time": 10, "skin": "default"}
}
}
mediateca[id_div_ReproductorMultimedia] =  typeof(psd) != "undefined" &&  typeof(psd.media) != "undefined" && typeof(psd.media.TopEmbed) != "undefined"? new psd.media.TopEmbed(datosTOP) : null;
}
function Mediateca_VideoPlayer_articulo(datosVideo, divMultimedia){
var id_div_ReproductorMultimedia;
if (typeof(divMultimedia) == "undefined" )
{
id_div_ReproductorMultimedia = "multimediaPlayer_" + String(Math.random()).substr(2,9);
document.write('<div id="' + id_div_ReproductorMultimedia + '" style="width:100%;z-index:2;"></div>');
}
else
id_div_ReproductorMultimedia = divMultimedia;
if (typeof(datosVideo.autoplay) == "undefined")
datosVideo.autoplay = true;
var keywords = "";
if (datosVideo.tagsNombreNormalizado != undefined && datosVideo.tagsNombreNormalizado != "")
keywords = datosVideo.tagsNombreNormalizado;
else
if (typeof(listado_norm_tags) != "undefined" && listado_norm_tags != "")
keywords = listado_norm_tags;
if (datosVideo.keywordsVideo != undefined && datosVideo.keywordsVideo != "")
{
if (keywords != "")
keywords += "," + datosVideo.keywordsVideo;
else
keywords = datosVideo.keywordsVideo;
}
if (datosVideo.agrsNombreNormalizado != undefined && datosVideo.agrsNombreNormalizado != "")
{
if (keywords != "")
keywords += "," + datosVideo.agrsNombreNormalizado;
else
keywords = datosVideo.agrsNombreNormalizado;
}
var datosTOP = {
"id_container": id_div_ReproductorMultimedia,
"id_cuenta": id_cuenta_mediateca_PEP,
"id_player": id_player_mediateca_PEP,
"id_media": datosVideo.id_multimedia,
"media_type": "video",
"keywords": datosVideo.keywordsVideo,

"playList" : {
"URL_list":"//gapi.prisasd.com/api/v1/search/diarioas/video/tags?tags=mn(idref|"+datosVideo.id_multimedia+")m("+datosVideo.canales_playlist+")&orderBy=modify_at|desc&size=20&itemIdref="+datosVideo.id_multimedia, 
"playListSkin" : "vacia", 
"autoNext":true,
"nextpanel": {"active": true, "time": 10, "skin": "default"}

},
"topPlayer":{
"media" : {
"autoplay": datosVideo.autoplay,
"ancho": datosVideo.anchoPlayer,
"alto": datosVideo.altoPlayer
},
"ad": {
"enabled": datosVideo.publiActiva,
"tags_noticia": keywords
}
},
"dev" : false
};
mediateca[id_div_ReproductorMultimedia] =  typeof(psd) != "undefined" &&  typeof(psd.media) != "undefined" && typeof(psd.media.TopEmbed) != "undefined"? new psd.media.TopEmbed(datosTOP) : null;
}
function Mediateca_VideoPlayer_playlist(datosVideo, divMultimedia){
var id_div_ReproductorMultimedia;
if (typeof(divMultimedia) == "undefined" )
{
id_div_ReproductorMultimedia = "multimediaPlayer_" + String(Math.random()).substr(2,9);
document.write('<div id="' + id_div_ReproductorMultimedia + '" style="width:100%;z-index:2;"></div>');
}
else
id_div_ReproductorMultimedia = divMultimedia;
var keywords = "";
if (datosVideo.tagsNombreNormalizado != undefined && datosVideo.tagsNombreNormalizado != "")
keywords = datosVideo.tagsNombreNormalizado;
else
if (typeof(listado_norm_tags) != "undefined" && listado_norm_tags != "")
keywords = listado_norm_tags;
if (datosVideo.keywordsVideo != undefined && datosVideo.keywordsVideo != "")
{
if (keywords != "")
keywords += "," + datosVideo.keywordsVideo;
else
keywords = datosVideo.keywordsVideo;
}
if (datosVideo.agrsNombreNormalizado != undefined && datosVideo.agrsNombreNormalizado != "")
{
if (keywords != "")
keywords += "," + datosVideo.agrsNombreNormalizado;
else
keywords = datosVideo.agrsNombreNormalizado;
}
var datosTOP = {
"dev": false, 
"id_cuenta": id_cuenta_mediateca_PEP, 
"media_type": "video", 
"id_player": id_player_mediateca_PEP,
"id_media": datosVideo.id_multimedia, 
"keywords": datosVideo.keywordsVideo,
"topPlayer":{
"media" : {
"autoplay": true,
"ancho": datosVideo.anchoPlayer,
"alto": datosVideo.altoPlayer
},
"ad": {
"enabled": datosVideo.publiActiva,
"tags_noticia": keywords
}
},
"id_container": id_div_ReproductorMultimedia, 
"playList":{
"URL_list": "//gapi.prisasd.com/api/v1/search/diarioas/video/tags?tags=mn(idref|"+datosVideo.id_multimedia+")m("+datosVideo.canales_playlist+")&orderBy=modify_at|desc&size=20&itemIdref="+datosVideo.id_multimedia, 
"id_container_playlist": "videos_rel_mediateca", 
"styleItemsContainer":"lista", 
"playListSkin" : "generica",
"autoNext":true, 
"reload_secs": 0, 
"nextpanel": {"active": true, "time": 10, "skin": "default"}
}
};
mediateca[id_div_ReproductorMultimedia] =  typeof(psd) != "undefined" &&  typeof(psd.media) != "undefined" && typeof(psd.media.TopEmbed) != "undefined"? new psd.media.TopEmbed(datosTOP) : null;
}
function PlayerMultimedia(datosMultimedia, divMultimedia)
{
var id_div_ReproductorMultimedia;
if (typeof(divMultimedia) == "undefined" )
{
id_div_ReproductorMultimedia = "multimediaPlayer_" + String(Math.random()).substr(2,9);
document.write('<div id="' + id_div_ReproductorMultimedia + '"></div>');
}
else
id_div_ReproductorMultimedia = divMultimedia;
switch(datosMultimedia.tipo)
{
case "video":
if (datosMultimedia.id_referencia)
datosMultimedia.idRefBrightcove = datosMultimedia.id_referencia;
if (datosMultimedia.id)
datosMultimedia.id_video = datosMultimedia.id;
if (datosMultimedia.player)
datosMultimedia.playerVideo = datosMultimedia.player;
if (datosMultimedia.titulo)
datosMultimedia.tituloVideo = datosMultimedia.titulo;
if (datosMultimedia.keywords)
datosMultimedia.keywordsVideo = datosMultimedia.keywords;
if (!datosMultimedia.playerEPETParams)
datosMultimedia.playerEPETParams = {"mediaWidth":datosMultimedia.anchoPlayer, "mediaHeight":datosMultimedia.altoPlayer, "URLMediaFile":"", "URLMediaStill":datosMultimedia.poster, "URLFirstFrame":"", "compactMode": 'false'};
var video = new EPET_Video(datosMultimedia, id_div_ReproductorMultimedia);
break;
case "audio":
if (datosMultimedia.id)
datosMultimedia.id_audio = datosMultimedia.id;
if (datosMultimedia.player)
datosMultimedia.playerAudio = datosMultimedia.player;
if (datosMultimedia.titulo)
datosMultimedia.tituloAudio = datosMultimedia.titulo;
if (datosMultimedia.keywords)
datosMultimedia.keywordsAudio = datosMultimedia.keywords;
var audio = new EPET_Audio(datosMultimedia, id_div_ReproductorMultimedia);
break;
case "externo":
var url = datosMultimedia.src;
if (datosMultimedia.src && datosMultimedia.src.substr(datosMultimedia.src.length -3,3) == "mp3")
{
datosMultimedia.id_audio = String(Math.random()).substr(2,9);
if (datosMultimedia.player)
datosMultimedia.playerAudio = datosMultimedia.player;
if (datosMultimedia.titulo)
datosMultimedia.tituloAudio = datosMultimedia.titulo;
if (datosMultimedia.keywords)
datosMultimedia.keywordsAudio = datosMultimedia.keywords;
var audio = new EPET_Audio(datosMultimedia, id_div_ReproductorMultimedia);
}
else
{
var url = eligeUrlenlace(datosMultimedia.urls);
if (url != "")
{
var iframe = document.createElement("iframe");
iframe.setAttribute("width",datosMultimedia.anchoPlayer);
iframe.setAttribute("height",datosMultimedia.altoPlayer);
iframe.setAttribute("scrolling", "no");
iframe.frameBorder = 0;
if ((document.location.href.indexOf("autoplay=1") > -1 || (typeof(videos_con_autoplay) != 'undefined' && videos_con_autoplay === true)) && !reproduciendo)
{
reproduciendo = true;
datosMultimedia.autoplay = true;
setTimeout(function(){
var posVideo = EPET_calculaTopPosition(document.getElementById(id_div_ReproductorMultimedia));
if (posVideo > dimensionesPEP.alto)
EPET_setScrollPosition(parseInt(posVideo) - 90);
},300);
}
if (datosMultimedia.autoplay)
{
if (url.match(/muzu/i))
{
url = url.replace(/&(amp;)?autostart=n/,"");
url += "&autostart=y";
}
else
if (url.match(/youtube/i))
url += "?autoplay=1";
}
if (url.match(/youtube/i))
{
if(url.indexOf('?') > -1)
url += "&wmode=transparent";
else
url += "?wmode=transparent";
}
iframe.src = url;
document.getElementById(id_div_ReproductorMultimedia).appendChild(iframe);
}
}
break;
default:
break;
}
}
var css_videos_cargado = false;
var EPET_Video = function(datosVideo,  idDivVideo, borrar)
{
this.objvideo = function()
{
return _datosVideo.nodoVideo;
}
this.cargaDatos = function(datos)
{
if (typeof(datos) == "undefined")
{
return;
}
if ((!datos.mp4 || datos.mp4.indexOf("http") != 0) && _datosVideo.playerEPETParams.URLMediaFile && _datosVideo.playerEPETParams.URLMediaFile != "")
{
datos.status = 100;
datos.mp4 = _datosVideo.playerEPETParams.URLMediaFile;
datos.ftgrm1 = _datosVideo.playerEPETParams.URLMediaStill;
}
if ( datos.status != 100)
{
EPET_VideoPlayerBloqueado(datos.id_video, _datosVideo.anchoFotograma, _datosVideo.altoFotograma, _datosVideo.playerEPETParams.URLMediaStill, datos.status, _idDivVideo);
if (_datosVideo.modoSiguientesVideos > 0 && SiguientesVideosPEP.videoWallData != null)
{
SiguientesVideosPEP.cuenta_atras_error = setTimeout(function(){
{
var canal = _datosVideo.agrsNombreNormalizado.split(",")[0];
siguientesVideos(canal, _datosVideo.id_video);
return;
}
},3000)}
return;
}
var cad_video = datos.mp4.replace(/^.*\//,"");
_datosVideo.playerEPETParams.URLMediaFile = (datos.mp4.indexOf('/') == 0) ? url_cache + datos.mp4 : datos.mp4;
_datosVideo.playerEPETParams.URLFirstFrame = (datos.ftgrm1.indexOf('/') == 0) ? url_cache + datos.ftgrm1 : datos.ftgrm1;
_datosVideo.src = _datosVideo.playerEPETParams.URLMediaFile;
_datosVideo.poster = _datosVideo.playerEPETParams.URLFirstFrame;
_datosVideo.uid = datos.uid;
_datosVideo.seccion_creacion = _datosVideo.keywordsVideo ? _datosVideo.keywordsVideo.replace(/,?agencia_.*/,"") : datos.seccion_creacion;
_datosVideo.fuente = datos.fuente;
_datosVideo.duracion = typeof(datos.duracion) != "undefined" ? datos.duracion : 0;
if (datos.sprite && !_datosVideo.spriteImg)
{
_datosVideo.spriteImg = ( datos.sprite.indexOf('/') == 0) ? url_cache + datos.sprite :datos.sprite;
_datosVideo.nSprites = (datos.n_sprites) ? datos.n_sprites : 0;
}
if (_datosVideo.playerEPETParams.URLMediaFile.indexOf("rtmp") == 0)
_datosVideo.rtmpStream = datos.rtmpStream;
_datosVideo.urlNoticia = datos.url_noticia ? datos.url_noticia : document.location.pathname;
_datosVideo.tituloVideo = datos.titulo ? datos.titulo : PAGE_TITLE;
_datosVideo.tagsNombreNormalizado = datos.tags_names ? datos.tags_names : (typeof(listado_norm_tags) != "undefined" ? listado_norm_tags : "");
if (typeof(datos.tags_ids) != "undefined" && datos.tags_ids != "" )
_datosVideo.tagsIds = datos.tags_ids;
else
if (typeof(_datosVideo.tagsIds) == "undefined")
_datosVideo.tagsIds = "";
if (_datosVideo.agrsIds != undefined && _datosVideo.agrsIds != "")
{
if (_datosVideo.tagsIds != "")
_datosVideo.tagsIds += ',';
_datosVideo.tagsIds += _datosVideo.agrsIds;
}
_datosVideo.autoresIds = (typeof(datos.author_ids) != "undefined") ? datos.author_ids : "";
_divVideo.style.height = _datosVideo.altoPlayer+"px";
_marcado._datosMarcado.myStreamingTag = null;
if (typeof(ns_) != "undefined")
_marcado._datosMarcado.myStreamingTag = new ns_.StreamingTag({ customerC2: (typeof(_satellite) != "undefined" ? _satellite.getVar("comscore").id : "8671776") });
if (_HTML5vsFLASH == "flash")
creaPlayerFlash();
else
{
_mainController.cargaDatos(_datosVideo);
}
}
this.play = function()
{
if (_HTML5vsFLASH == "flash")
{
if (document.getElementById(_idObjeto) && typeof(document.getElementById(_idObjeto).playjs) != "undefined")
{
document.getElementById(_idObjeto).playjs();
}
}
else
{
_datosVideo.nodoVideo.play();
}
MultimediaReproduciendo(_datosVideo.id_video, false);
}
this.pause = function()
{
if (_HTML5vsFLASH == "flash")
{
if (document.getElementById(_idObjeto) && typeof(document.getElementById(_idObjeto).pausejs) != "undefined")
document.getElementById(_idObjeto).pausejs();
}
else
{
if (isIpad)
{
if ( _mainController.adPlaying)
{
_mainController.restart();
_mainController.playerHTML5.adContainer.innerHTML = "";
_mainController.playerHTML5.controles.style.display = 'none';
_mainController.playerHTML5.adContainer.style.display = 'none';
}
}
if (_mainController)
_mainController.pause();
}
}
this.stop = function()
{
if (_HTML5vsFLASH == "html5")
{
_mainController.restart();
}
}
this.marcado = function(datos)
{
if (datos.duracion != undefined)
_marcado._datosMarcado.duracion = datos.duracion;
if (datos.playerName != undefined)
_marcado._datosMarcado.playerName = datos.playerName;
if (datos.ad != undefined)
_marcado._datosMarcado.ad = datos.ad;
if (datos.adCue != undefined)
_marcado._datosMarcado.adCue = datos.adCue;
if (datos.adTitle != undefined)
_marcado._datosMarcado.adTitle = datos.adTitle;
if (datos.uid != undefined)
_marcado._datosMarcado.uid = datos.uid;
if (datos.seccion_creacion != undefined)
_marcado._datosMarcado.seccion_creacion = datos.seccion_creacion;
if (datos.fuente != undefined)
_marcado._datosMarcado.fuente = datos.fuente;
if (datos.tags != undefined)
_marcado._datosMarcado.tags = datos.tags;
if (datos.autores != undefined)
_marcado._datosMarcado.autores = datos.autores;
if (datos.currentTime != undefined)
_marcado._datosMarcado.currentTime = datos.currentTime;
else
_marcado._datosMarcado.currentTime = -1;
if (datos.adCurrentTime != undefined)
_marcado._datosMarcado.adCurrentTime = datos.adCurrentTime;
else
_marcado._datosMarcado.adCurrentTime = -1;
if (datos.evento == "adStart" || datos.evento == "adComplete" || datos.evento == "adSkip" ||
datos.evento == "adError" || datos.evento == "mediaBegin" || datos.evento == "mediaComplete" ||
datos.evento == "halfmediaComplete" || datos.evento == "adRequest" ||
datos.evento == "adPaused" || datos.evento == "adResumed" ||
datos.evento == "mediaPaused" || datos.evento == "mediaResumed")
_marcado.marcaEvento(datos.evento);
}
this.seek = function(segundo)
{
if (_HTML5vsFLASH == "flash")
{
if (document.getElementById(_idObjeto))
{
document.getElementById(_idObjeto).seekjs(segundo);
}
}
else
{
if (_HTML5vsFLASH == "html5")
{
if (_mainController.adPlaying)
return;
_mainController.seekjs(segundo);
}
}
MultimediaReproduciendo(_datosVideo.id_video, false);
}
this.resetMarcado = function(id)
{
_marcado.eventos = {};
if (typeof(ns_) != "undefined")
_marcado._datosMarcado.myStreamingTag = new ns_.StreamingTag({ customerC2: (typeof(_satellite) != "undefined" ? _satellite.getVar("comscore").id : "8671776") });
else
_marcado._datosMarcado.myStreamingTag = null;
if (_datosVideo.modoSiguientesVideos > 0 )
{
var canal = _datosVideo.agrsNombreNormalizado.split(",")[0];
siguientesVideos(canal, id);
return;
}
}
this.tipo = function()
{
return _HTML5vsFLASH;
}
this.uid = function()
{
return _datosVideo.uid;
}
this.seccion_creacion = function()
{
return _datosVideo.seccion_creacion;
}
this.fuente = function()
{
return _datosVideo.fuente;
}
this.tags = function()
{
return _datosVideo.tagsIds;
}
this.autores = function()
{
return _datosVideo.autoresIds;
}
this.changeOrientation = changeOrientation;
if (datosVideo.idRefBrightcove)
datosVideo.id_referencia = datosVideo.idRefBrightcove;
if (datosVideo.playerVideo)
datosVideo.player = datosVideo.playerVideo;
if (datosVideo.tituloVideo)
datosVideo.titulo = datosVideo.tituloVideo;
if (datosVideo.keywordsVideo)
datosVideo.keywords = datosVideo.keywordsVideo;
var _datosVideo = datosVideo;
var _idDivVideo = idDivVideo;
var _divVideo = document.getElementById(_idDivVideo);
_divVideo.className = "video_MPEP";
var cadena_titulo;
if (_datosVideo.tituloVideo != undefined && _datosVideo.tituloVideo != "")
cadena_titulo = _datosVideo.tituloVideo;
else
cadena_titulo = PAGE_TITLE;
var _id_video;
if (_datosVideo.id_video)
_id_video = _datosVideo.id_video;
else
{
if (_datosVideo.un)
UN = _datosVideo.un;
_id_video = _datosVideo.id_referencia + UN;
}
_id_video += '-' + (++contadorMultimedia);
var _idDivImage = "divimg_" + _id_video;
var _imgCaratula = "caratula_" + _id_video;
var _divCaratula = document.createElement("div");
_divCaratula.id = _idDivImage;
_divCaratula.style.zIndex = 1;
_divCaratula.className = "img_MPEP";
if (typeof(_datosVideo.modoReproduccion) == "undefined")
_datosVideo.modoReproduccion = "";
if (dispositivoMovil && typeof(_datosVideo.autoplay) == "boolean")
_datosVideo.autoplay = false;


if (versionMovil || MPEP_article)
{
var ancho_ref = (typeof(_divVideo.parentNode.parentNode) != "undefined" && _divVideo.parentNode.parentNode.offsetWidth > 0)? _divVideo.parentNode.parentNode.offsetWidth: 640;
_altoMovil = Math.floor(ancho_ref * _datosVideo.altoPlayer / _datosVideo.anchoPlayer);
_anchoMovil = (ancho_ref);
_altoMovilCaratula = Math.floor(ancho_ref * _datosVideo.altoFotograma / _datosVideo.anchoFotograma);
_anchoMovilCaratula = (ancho_ref);
_datosVideo.anchoPlayer = _anchoMovil;
_datosVideo.altoPlayer = _altoMovil;
_divVideo.style.width = _anchoMovilCaratula + "px"
_divVideo.style.height = _altoMovilCaratula + "px";
_divVideo.style.overflow = "hidden";
if(!MPEP_article && versionMovil){
_divCaratula.style.width = _anchoMovilCaratula + "px";
_divCaratula.style.height = _altoMovilCaratula + "px";
_divCaratula.style.overflow = "hidden";
}
EPETaddEvent(window, orientationEvent, function(){
clearTimeout(_resizeTM);
_resizeTM = setTimeout( function() {
changeOrientation()}, 300)
});
}else if(MPEP_responsive){
var ancho_ref = "100%";
if(_datosVideo.altoFotograma)
var alto_ref = _datosVideo.altoFotograma;
else
var alto_ref = (typeof(_divVideo.parentNode) != "undefined" && _divVideo.parentNode.offsetHeight > 0)? _divVideo.parentNode.offsetHeight: 390;
_altoMovil = (alto_ref);
_anchoMovil = ancho_ref;
_datosVideo.anchoPlayer = _datosVideo.anchoPlayer;
_datosVideo.altoPlayer = _datosVideo.altoPlayer;
_divVideo.style.width = _anchoMovil;
_divVideo.style.height = _altoMovil + "px";
_divVideo.style.overflow = "hidden";
EPETaddEvent(window, orientationEvent, function(){
clearTimeout(_resizeTM);
_resizeTM = setTimeout( function() {
changeOrientation()}, 300)
});
}else
{
_divVideo.style.minHeight = _datosVideo.altoFotograma + "px";
_divVideo.parentNode.parentNode.style.minHeight = _datosVideo.altoFotograma + "px";
}


if(versionMovil || MPEP_article)
_divVideo.style.backgroundColor = "#000000";
_datosVideo.modoSiguientesVideos = (modoSiguientesVideos == 0 || typeof(_datosVideo.agrsNombreNormalizado) == "undefined" || _datosVideo.agrsNombreNormalizado == "") ? 0 : (typeof(_datosVideo.modoPlayer) != "undefined" && _datosVideo.modoPlayer != '0' ? _datosVideo.modoPlayer : modoSiguientesVideos);
if (typeof(MultimediaPEP_originales[_idDivVideo]) == "undefined") {
MultimediaPEP_originales[_idDivVideo] = JSON.parse(JSON.stringify(datosVideo));
}
else
{
if (_datosVideo.modoSiguientesVideos > 0 && borrar)
SiguientesVideosPEP.paraBorrar.push(_id_video);
}
MultimediaPEP[_id_video] = new Object();
MultimediaPEP[_id_video].multimedia = this;
MultimediaPEP[_id_video].modoSiguientesVideos = _datosVideo.modoSiguientesVideos;
MultimediaPEP[_id_video].datos = JSON.parse(JSON.stringify(MultimediaPEP_originales[_idDivVideo]));
MultimediaPEP[_id_video].datos.anchoFotograma_orig = MultimediaPEP[_id_video].datos.anchoFotograma;
MultimediaPEP[_id_video].datos.altoFotograma_orig = MultimediaPEP[_id_video].datos.altoFotograma;
MultimediaPEP[_id_video].id = idDivVideo;
_datosVideo.id_video = _id_video;
var primero_flash = videoFlash && !versionMovil;
if ((_datosVideo.forzarHTML5 != undefined && _datosVideo.forzarHTML5) || (typeof(EPET_forzarHTML5) != "undefined" && EPET_forzarHTML5))
primero_flash = false;
var _marcado = new EPET_Marcado_Multimedia({"referencia":_datosVideo.id_video,"titulo": cadena_titulo, "keywords": _datosVideo.keywordsVideo != undefined ? _datosVideo.keywordsVideo : "", "media":"video" });
if (datosVideo.tipoReproduccion && datosVideo.tipoReproduccion == "streaming")
{
_marcado._datosMarcado.tipoReproduccion = "streaming";
_datosVideo.publicidad_post_roll = false;
}
else
{
_marcado._datosMarcado.tipoReproduccion = "vod";
if (_datosVideo.modoSiguientesVideos == 0 )
_datosVideo.publicidad_post_roll = true;
else
{
_datosVideo.publicidad_post_roll = false;
if (typeof (_datosVideo.idx_siguientes_videos) == "undefined")
_datosVideo.idx_siguientes_videos = 0;
var key = _datosVideo.idx_siguientes_videos == 0 ? SiguientesVideosPEP.keyword_primero : SiguientesVideosPEP.keyword_siguientes;
if (typeof(_datosVideo.keywordsVideo) == "undefined" || _datosVideo.keywordsVideo == "")
_datosVideo.keywordsVideo = key;
else
_datosVideo.keywordsVideo += "," + key;
_marcado._datosMarcado.posSiguientesVideos = _datosVideo.idx_siguientes_videos;
}
}
var _idPosicionador = "posicionador_" + _id_video;
var _idObjeto = "obj_" + _id_video;
var _duration = 0;
var _firstTime = false;
var _anchoMovil = _datosVideo.anchoPlayer;
var _altoMovil = _datosVideo.altoPlayer;
var fullscreen_HTML5 = false;
var _resizeTM;
var _mainController;
var intervalTimmerFotograma;
var urlAdServer;
var _HTML5vsFLASH = "";
if (!dispositivoMovil && (document.location.href.indexOf("autoplay=1") > -1 || (typeof(videos_con_autoplay) != 'undefined' && videos_con_autoplay === true)) && !reproduciendo && datosVideo.autoplay != false)
{
_datosVideo.modoReproduccion = "autoplay";
reproduciendo = true;
_datosVideo.autoplay = true;
var posVideo = EPET_calculaTopPosition(_divVideo);
if (posVideo > dimensionesPEP.alto)
EPET_setScrollPosition(posVideo - 30);
}
var codigoVideo = '<a class="posicionador" id="' + _idPosicionador + '" title="'+LANG_MSG[LANG].ver_video+'" href="javascript:void(0)">';
if(MPEP_responsive && !versionMovil){
var cod_img;
if (typeof(window.lzld) == 'function')
cod_img = '<img id="' + _imgCaratula + '" onload="lzld(this)" src="/t.gif" data-src="' + _datosVideo.playerEPETParams["URLMediaStill"] + '" />';
else
cod_img = '<img id="' + _imgCaratula + '" src="' + _datosVideo.playerEPETParams["URLMediaStill"] + '" />';
codigoVideo += cod_img + '<div  id="botonas_' + _idPosicionador + '" class="btn-multimedia">' +
'<span class="as-icon-play" onclick="OMNeventoAjax(\'29\',\'boton_astv\',\'event33\');"></span><span class="as-icon-astv" onclick="OMNeventoAjax(\'29\',\'boton_astv\',\'event33\');"></span></a></div>';
}else{
if (_anchoMovil > 300)
codigoVideo += '<span class="mosca_astv"></span>';
var cod_img;
if (typeof(window.lzld) == 'function')
cod_img = '<img width="'+_datosVideo.anchoFotograma+'" height="'+_datosVideo.altoFotograma+'" id="' + _imgCaratula + '" onload="lzld(this)" src="/t.gif" data-src="' + _datosVideo.playerEPETParams["URLMediaStill"] + '" />';
else
cod_img = '<img width="'+_datosVideo.anchoFotograma+'" height="'+_datosVideo.altoFotograma+'" id="' + _imgCaratula + '" src="' + _datosVideo.playerEPETParams["URLMediaStill"] + '" />';
codigoVideo += '<span class="boton_video"></span>'+ cod_img +
'</a><div id="botonas_' + _idPosicionador + '" class="astv-player"><span class="icon-astv icon"></span><span class="img-info img-video s-inb-sm"><a onclick="OMNeventoAjax(\'29\',\'boton_astv\',\'event33\');" class="icon icon-L i-l-play" href="javascript:void(0)"> Reproducir vídeo </a></span></div>';
}
if (_datosVideo.autoplay && _datosVideo.modoSiguientesVideos > 0)
{
_divCaratula.style.display = 'none';
}
_divCaratula.innerHTML = codigoVideo;
_divVideo.appendChild(_divCaratula);
var _span = document.getElementById(_idPosicionador);
var _botonas = document.getElementById("botonas_" + _idPosicionador);
if (_datosVideo.autoplay && !dispositivoMovil)
{
if (_datosVideo.modoReproduccion == "")
_datosVideo.modoReproduccion = "autoplay";
if (!isIE && code_ima3_HTML5_cargado == "nocargado")
{
code_ima3_HTML5_cargado = "cargado";
var ss = document.createElement('script');
ss.type= 'text/javascript';
ss.src = '//s0.2mdn.net/instream/html5/ima3.js';
document.getElementsByTagName('head')[0].appendChild(ss);
}
intervalTimmerFotograma = setTimeout(function(){_divCaratula.style.display = "none";},4000);
if ( !css_videos_cargado)
{
css_videos_cargado = true;
loadCSS(css_multimedia, function(){setTimeout(dibujaPlayer,1500)});
if(versionMovil)
{
var css_movil = document.createElement("link");
css_movil.type = "text/css";
css_movil.rel = "stylesheet";
css_movil.href = css_multimedia_movil;
document.getElementsByTagName("head")[0].appendChild(css_movil);
}
EPETaddEvent(document, mouseWheelEvent, wheel);
}
else
dibujaPlayer();
_span.className += " video_cargando";
_botonas.style.display = "none";
}
else
{
if ( !css_videos_cargado)
{
css_videos_cargado = true;
var css = document.createElement("link");
css.type = "text/css";
css.rel = "stylesheet";
css.href = css_multimedia;
document.getElementsByTagName("head")[0].appendChild(css);
if(versionMovil)
{
var css_movil = document.createElement("link");
css_movil.type = "text/css";
css_movil.rel = "stylesheet";
css_movil.href = css_multimedia_movil;
document.getElementsByTagName("head")[0].appendChild(css_movil);
}
EPETaddEvent(document, mouseWheelEvent, wheel);
}
if (!isIE && code_ima3_HTML5_cargado == "nocargado")
{
code_ima3_HTML5_cargado = "cargando";
var ss = document.createElement('script');
ss.type= 'text/javascript';
ss.src = '//s0.2mdn.net/instream/html5/ima3.js';
if (document.all)
ss.onreadystatechange = function(){
if (ss.readyState == 'complete' || ss.readyState == 'loaded')
code_ima3_HTML5_cargado = "cargado";
}
else
ss.onload = function() {
code_ima3_HTML5_cargado = "cargado";
};
document.getElementsByTagName('head')[0].appendChild(ss);
}
_divVideo.onclick = function()
{
_datosVideo.modoReproduccion = "organico";
_divVideo.onclick = null;
dibujaPlayer();
MultimediaReproduciendo(_datosVideo.id_video, false);
if (versionMovil || MPEP_responsive) changeOrientation();
}
}
function changeOrientation()
{
var ref = (typeof(_divVideo.parentNode) != "undefined" && _divVideo.parentNode.offsetWidth > 0)? _divVideo.parentNode.offsetWidth: 640;
_datosVideo.altoPlayer = Math.floor(ref * _datosVideo.altoPlayer / _datosVideo.anchoPlayer);
_datosVideo.anchoPlayer = ref;
_altoMovilCaratula = Math.floor(ref * _datosVideo.altoFotograma / _datosVideo.anchoFotograma);
_anchoMovilCaratula = ref;
if ( _divCaratula.style.display != "none")
{
_divVideo.style.width = _anchoMovilCaratula + "px"
_divVideo.style.height = _altoMovilCaratula + "px";
_divVideo.style.overflow = "hidden";
_divCaratula.style.width = _anchoMovilCaratula + "px";
_divCaratula.style.height = _altoMovilCaratula + "px";
_divCaratula.style.overflow = "hidden";
if(!MPEP_responsive && versionMovil){
document.getElementById(_imgCaratula).style.width = _anchoMovilCaratula + "px";
document.getElementById(_imgCaratula).style.height = _altoMovilCaratula + "px";
}
}
else
{
_divVideo.style.width = _datosVideo.anchoPlayer + "px"
_divVideo.style.height = _datosVideo.altoPlayer + "px";
_divVideo.style.overflow = "hidden";
if(MPEP_responsive){
_divCaratula.style.width = _datosVideo.anchoPlayer + "px";
_divCaratula.style.height = _datosVideo.altoPlayer + "px";
}
_divCaratula.style.overflow = "hidden";
if (_mainController && _mainController.adsController)
_mainController.adsController.resize(_datosVideo.anchoPlayer,_datosVideo.altoPlayer);
if (_datosVideo.nodoVideo != null)
{
_datosVideo.nodoVideo.setAttribute("width", _datosVideo.anchoPlayer);
_datosVideo.nodoVideo.setAttribute("height", _datosVideo.altoPlayer);
if (_mainController.playerHTML5.controles)
{
if(versionMovil || MPEP_article)
var limite = _datosVideo.anchoPlayer > 640 ? 640 : _datosVideo.anchoPlayer;
else
var limite = _datosVideo.anchoPlayer;
if (_mainController.playerHTML5.controles.barra)
{
_mainController.playerHTML5.controles.barra.style.width = (limite - _mainController.playerHTML5.ancho_controles) + "px";
_mainController.playerHTML5.controles.barra.sliderseek.style.width = _mainController.playerHTML5.controles.barra.style.width;
_mainController.playerHTML5.controles.style.width = limite + "px";
}
if (_mainController.playerHTML5.controles.offsetWidth < 640)
_mainController.playerHTML5.controles.style.left = Math.floor((limite - _mainController.playerHTML5.controles.offsetWidth) / 2) + "px";
}
}
else
{
if (_datosVideo.idObjeto && document.getElementById(_datosVideo.idObjeto))
{
document.getElementById(_datosVideo.idObjeto).width = _datosVideo.anchoPlayer;
document.getElementById(_datosVideo.idObjeto).height = _datosVideo.altoPlayer;
}
}
}
if (_datosVideo.modoSiguientesVideos > 0)
{
MultimediaPEP[_id_video].datos.anchoPlayer = _datosVideo.anchoPlayer;
MultimediaPEP[_id_video].datos.altoPlayer = _datosVideo.altoPlayer;
}
}
function ocultaFotograma()
{
clearTimeout(intervalTimmerFotograma);
_divCaratula.style.display = "none";
}
function dibujaPlayer()
{
_divVideo.style.height = _datosVideo.altoPlayer + "px";
if (typeof(_datosVideo.publiActiva) == "string")
if (_datosVideo.publiActiva == "true")
_datosVideo.publiActiva = true;
else
{
_datosVideo.publiActiva = false;
}
if (!_datosVideo.seekTimeout)
_datosVideo.seekTimeout = 7;
if (_datosVideo.publiActiva)
{
_datosVideo.publicidad_pre_roll = true;
}
else
{
_datosVideo.publicidad_pre_roll = false;
_datosVideo.publicidad_post_roll = false;
}
_marcado._datosMarcado.publicidad = _datosVideo.publiActiva ? "con publicidad" : "sin publicidad";
var keywords = "";
if (_datosVideo.tagsNombreNormalizado != undefined && _datosVideo.tagsNombreNormalizado != "")
keywords = _datosVideo.tagsNombreNormalizado;
else
if (typeof(listado_norm_tags) != "undefined" && listado_norm_tags != "")
keywords = listado_norm_tags;
if (_datosVideo.keywordsVideo != undefined && _datosVideo.keywordsVideo != "")
{
if (keywords != "")
keywords += "," + _datosVideo.keywordsVideo;
else
keywords = _datosVideo.keywordsVideo;
}
if (_datosVideo.agrsNombreNormalizado != undefined && _datosVideo.agrsNombreNormalizado != "")
{
_marcado._datosMarcado.agrs_video = _datosVideo.agrsNombreNormalizado;
if (keywords != "")
keywords += "," + _datosVideo.agrsNombreNormalizado;
else
keywords = _datosVideo.agrsNombreNormalizado;
}
keywords = "&hl=" + LANG + "&cust_params=pbskey%3D" + escape(keywords) + "%26pos%3D{cuePointType}" +
(typeof(PBS) != "undefined" && typeof(PBS.slm) != "undefined" && typeof(PBS.slm.cf.key.amzn_vid) == "string" ? "%26amzn_vid%3D" + escape(PBS.slm.cf.key.amzn_vid) + "%26amznslots%3D" + escape(PBS.slm.cf.key.amznslots) : "") +
(typeof(PBS) != "undefined" && typeof(PBS.slm) != "undefined" && typeof(PBS.slm.cf.key.ksg) != "undefined" ? "%26ksg%3D" + (PBS.slm.cf.key.ksg.join(",")): "");
if (_datosVideo.keywordsVideo.indexOf("agencia_overonaas") > -1 || _datosVideo.keywordsVideo.indexOf("agencia_reuters_live") > -1 || _datosVideo.keywordsVideo.indexOf("overon_stream") > -1)
urlAdServer = UrlPublicidadOveron + keywords;
else
urlAdServer = UrlPublicidad + keywords;
if (isIphone)
urlAdServer = urlAdServer.replace("sz=640x480", "sz=640x480|480x360");
else
urlAdServer = urlAdServer.replace("sz=640x480", "sz=640x480|480x361");
urlAdServer = urlAdServer.replace("[description_url]", document.location.origin + document.location.pathname);
_marcado._datosMarcado.duracion = 0;
_marcado._datosMarcado.adCue = "";
_marcado._datosMarcado.ad = "";
_marcado._datosMarcado.adTitle = "";
_marcado._datosMarcado.tags = "";
_marcado._datosMarcado.autores = "";
_marcado._datosMarcado.modoReproduccion = _datosVideo.modoReproduccion;
if ( primero_flash)
{
_HTML5vsFLASH = "flash";
pideDatosVideo(_id_video);
}
else
{
if (canPlayMP4)
{
_HTML5vsFLASH = "html5";
creaPlayerHTML5();
}
else
{
if  (videoFlash )
{
_HTML5vsFLASH = "flash";
pideDatosVideo(_id_video);
}
else
sinPlayer();
}
}
}
function creaPlayerFlash()
{
_datosVideo.adServerURL = urlAdServer + "%26fpd%3Dvpaid";
var params = {"menu":"false", "wmode":"opaque", "allowscriptaccess":"always", "bgcolor":"#000000", "allowfullscreen":"true" };
for(var key in _datosVideo.playerEPETOpcionesSWF)
{
params[key] = _datosVideo.playerEPETOpcionesSWF[key];
}
_datosVideo.autoplay = true;
_datosVideo.idioma = LANG;
_datosVideo.un = UN;
_datosVideo.enlazados = _datosVideo.modoSiguientesVideos > 0;
params["flashvars"] = "datosVideo=" + escape(JSON.stringify(_datosVideo));
var multimedia_player;
multimedia_player = new EPET_FlashHTML(10, url_reproductor_epet, _datosVideo.anchoPlayer, _datosVideo.altoPlayer, params, _idObjeto );
_datosVideo.idObjeto = _idObjeto;
multimedia_player.replace(_idDivVideo);
ocultaFotograma();
}
function creaPlayerHTML5()
{
if (_datosVideo.tipoReproduccion != undefined && _datosVideo.tipoReproduccion == "streaming")
{
if (_datosVideo.m3u8 == undefined || _datosVideo.m3u8 == "" || (!dispositivoMovil && !isMacSafari))
{
sinPlayer(1);
return;
}
}
if (_datosVideo.publiActiva && publicidad_HTML5 &&  code_ima3_HTML5_cargado == "cargado" )
{
_datosVideo.publicidad_pre_roll = true;
_datosVideo.publicidad_post_roll = _datosVideo.publicidad_post_roll && postroll_HTML5;
}
else
{
_datosVideo.publiActiva = false;
_datosVideo.publicidad_pre_roll = false;
_datosVideo.publicidad_post_roll = false;
}
if (_marcado._datosMarcado.tipoReproduccion == "streaming")
_marcado._datosMarcado.playerName = "HTML5 VÍDEO V2 - Transmisiones";
else
_marcado._datosMarcado.playerName = "HTML5 VÍDEO V2";
_datosVideo.marcado = _marcado;
_datosVideo.adServerURL = urlAdServer.replace("%2Fflash","%2Fhtml5");
if (isIphone)
_datosVideo.adServerURL = _datosVideo.adServerURL.replace("pbskey%3D","pbskey%3Dno_skip%2C");
_datosVideo.nodoVideo = document.createElement("video");
if (dispositivoMovil)
_datosVideo.nodoVideo.play();
_mainController = new MainController(new playerHTML5(_divVideo,_datosVideo));
pideDatosVideo(_id_video);
ocultaFotograma();
}
function sinPlayer(cod)
{
clearTimeout(intervalTimmerFotograma);
var divFondo = document.createElement("div");
divFondo.className = "video_previa video_no_disponible s-pr";
switch(cod) {
case 1:
texto_error = LANG_MSG[LANG].trans_no_disponible;
break;
default :
if (versionFlash > 0) {
texto_error = LANG_MSG[LANG].actualizar_plugin;
}
else {
texto_error = LANG_MSG[LANG].no_mp4;
}
break;
}
divFondo.innerHTML = '<div class="cnt-media-msg s-pa"><div class="ntc-media-msg"><p class="icon-astv icon ico-msg-video"></p><span class="s-tcenter ntc-media-msg-txt">'+texto_error+'</span></div></div><img src="'+_datosVideo.playerEPETParams.URLMediaStill + '" width="' + _datosVideo.anchoFotograma + '" height="' + _datosVideo.altoFotograma + '"/>';
_span.parentNode.parentNode.appendChild(divFondo);
}
}
var playerHTML5 = function(contenedor, datosVideo)
{
this.contenedorVideo = typeof contenedor == 'object' ? contenedor : document.getElementById(contenedor);
this.datosVideo = datosVideo;
this.width = this.datosVideo.anchoPlayer;
this.height = this.datosVideo.altoPlayer;
this.contenedorVideo.style.width = this.width + "px";
this.contenedorVideo.style.height = this.height + "px";
this.contenedorVideo.className = "playerMPEPV_c_video playerMPEPV_unselectable";
this.contenedorVideo.style.overflow = 'visible';
this.adContainer = null;
this.controles = null;
this.adTagUrl = this.datosVideo.adServerURL;
this.primeraVez = true;
this.autoplay = this.datosVideo.autoplay;
this.controlesNativosVideo = controlesNativosVideo ? controlesNativosVideo : (dispositivoMovil || isMacSafari ? true : false);
this.adSaltar = null;
this.playing = false;
this.marcado = this.datosVideo.marcado;
this.nodoVideo = this.datosVideo.nodoVideo;
this.nodoVideo.setAttribute("width", this.width);
this.nodoVideo.setAttribute("height", this.height);
this.nodoVideo.style.position = 'absolute';
this.nodoVideo.style.zIndex = 0;
this.nodoVideo.style.top = '0px';
this.nodoVideo.style.left = '0px';
this.nodoVideo.setAttribute("id", "pepvideo_" + this.datosVideo.id_video);
if (this.datosVideo.modoSiguientesVideos == 0)
this.nodoVideo.setAttribute("poster", this.datosVideo.playerEPETParams.URLMediaStill);
this.nodoVideo.style.display = 'none';
this.contenedorVideo.appendChild(this.nodoVideo);
this.volumenActual = this.nodoVideo.volume;
this.ancho_controles = 0;
if (typeof(google) == "undefined" || typeof(google.ima) == "undefined")
this.datosVideo.publiActiva = false;
if (this.datosVideo.publiActiva)
{
this.adContainer = document.createElement('div');
this.adContainer.style.position = "absolute";
this.adContainer.style.cursor = "pointer";
this.adContainer.style.left = "0px";
this.adContainer.style.top = "0px";
if(MPEP_responsive){
var ref = (typeof(this.nodoVideo.parentNode) != "undefined" && this.nodoVideo.parentNode.offsetWidth > 0)? this.nodoVideo.parentNode.offsetWidth: 640;
this.adContainer.style.height = Math.floor(ref * this.height / this.width) + "px";
this.adContainer.style.width = ref + "px";
}else{
this.adContainer.style.width = this.width + "px";
this.adContainer.style.height = this.height + "px";
}
this.adContainer.style.zIndex = 2;
this.contenedorVideo.appendChild(this.adContainer);
if (!isIphone)
{
this.creaControles();
this.adSaltar = document.createElement('div');
this.adSaltar.className = "playerMPEPV_adsaltar";
if (dispositivoMovil)
this.adSaltar.innerHTML = '<img src="' + protocolUrl + '//as00.epimg.net/iconos/v1.x/v1.0/multimedia/video/vervideo.svg" width="146" height="40" border="0" style="width:146px;height:40px" \/>';
else
this.adSaltar.innerHTML = '<img src="' + protocolUrl + '//as00.epimg.net/iconos/v1.x/v1.0/multimedia/video/vervideo.svg" width="84" height="23" border="0" style="width:84px;height:23px" \/>';
this.contenedorVideo.appendChild(this.adSaltar);
}
}
else
{
this.nodoVideo.style.display = 'block';
if (this.controlesNativosVideo)
this.nodoVideo.setAttribute ( "controls" , "controls" );
else
this.creaControles();
}
};
playerHTML5.prototype.preloadContent = function(contentLoadedAction) {
if (dispositivoMovil)
{
this.nodoVideo.addEventListener(
'loadedmetadata',
contentLoadedAction,
false);
this.nodoVideo.load();
}
else
contentLoadedAction();
};
playerHTML5.prototype.play = function() {
this.nodoVideo.play();
this.playing = true;
if (!this.controlesNativosVideo && this.controles)
this.controles.playpause.className = "playerMPEPV_boton_play_pause playerMPEPV_boton_pause";
MultimediaReproduciendo(this.datosVideo.id_video, false);
};
playerHTML5.prototype.pause = function() {
this.nodoVideo.pause();
this.playing = false;
if (!this.controlesNativosVideo && this.controles)
this.controles.playpause.className = "playerMPEPV_boton_play_pause playerMPEPV_boton_play";
};
playerHTML5.prototype.setVolume = function(volumen) {
if (volumen > 1 || volumen < 0 )
return;
this.nodoVideo.volume = volumen;
this.actualizaVolumen();
};
playerHTML5.prototype.actualizaVolumen = function()
{
var volumen = this.nodoVideo.volume || 0;
if (volumen == 0)
this.controles.volumen.nivel.style.height = '0px';
else
this.controles.volumen.nivel.style.height = (this.controles.volumen.maximo * volumen) + 'px';
};
playerHTML5.prototype.resize = function(
position, top, left, width, height) {
this.videoPlayerContainer.style.position = position;
this.videoPlayerContainer.style.top = top + 'px';
this.videoPlayerContainer.style.left = left + 'px';
this.videoPlayerContainer.style.width = width + 'px';
this.videoPlayerContainer.style.height = height + 'px';
this.nodoVideo.style.width = width + 'px';
this.nodoVideo.style.height = height + 'px';
};
playerHTML5.prototype.getVideoPlayer = function() {
return this.nodoVideo;
};
playerHTML5.prototype.creaControles = function() {
this.controles = document.createElement("div");
this.controles.className = "playerMPEPV_controles";
this.controles.style.zIndex = "10";
var ancho_maximo = 640;
var margen = 0;
this.controles.style.width =  this.width + "px";
ancho_maximo = this.width;
if(versionMovil || MPEP_article)
this.controles.style.visibility = 'hidden';
var boton_play_pause = document.createElement("span");
boton_play_pause.className = "playerMPEPV_boton_play_pause playerMPEPV_boton_play";
var em = document.createElement("em");
em.appendChild ( document.createTextNode ( "PLAY" ) );
boton_play_pause.appendChild(em);
this.controles.appendChild(boton_play_pause);
this.controles.playpause = boton_play_pause;
var tiempo = document.createElement("span");
tiempo.className = "playerMPEPV_posicion";
em = document.createElement("em");
em.appendChild ( document.createTextNode ( "00:00" ) );
tiempo.appendChild(em);
tiempo.texto = em;
this.controles.appendChild(tiempo);
this.controles.tiempo = tiempo;
var barra = document.createElement("span");
barra.className = "playerMPEPV_barra";
em = document.createElement("em");
barra.appendChild(em);
barra.progreso = em;
var sliderseek = document.createElement("div");
sliderseek.className = "playerMPEPV_sliderseek";
barra.appendChild(sliderseek);
barra.sliderseek = sliderseek;
this.controles.appendChild(barra);
this.controles.barra = barra;
var duracion = document.createElement("span");
duracion.className = "playerMPEPV_duracion";
em = document.createElement("em");
em.appendChild ( document.createTextNode ( "00:00" ) );
duracion.appendChild(em);
duracion.texto = em;
this.controles.appendChild(duracion);
this.controles.textoDuracion = duracion;
var pantalla_completa = document.createElement("span");
pantalla_completa.className = "playerMPEPV_pantalla_completa";
pantalla_completa.innerHTML = "PC";
this.controles.appendChild(pantalla_completa);
this.controles.fullscreen = pantalla_completa;
var volumen = document.createElement("span");
em = document.createElement("em");
var altavoz = document.createElement("span");
altavoz.className = "playerMPEPV_altavoz";
em.appendChild ( altavoz );
volumen.appendChild(em);
this.controles.appendChild(volumen);
volumen.altavoz = em;
volumen.style.position = "relative";
var slider = document.createElement("div");
slider.className = "playerMPEPV_slider";
var selectorNivel = document.createElement("div");
selectorNivel.className = 'playerMPEPV_selector_nivel';
selectorNivel.id = "vdpep_audio"
slider.appendChild(selectorNivel);
var nivel = document.createElement("div");
nivel.className = "playerMPEPV_nivel_slider";
slider.appendChild(nivel);
volumen.appendChild(slider);
volumen.slider = slider;
volumen.selectorNivel = selectorNivel;
volumen.nivel = nivel;
this.contenedorVideo.appendChild(this.controles);
this.controles.volumen = volumen;
slider.style.bottom = ( volumen.offsetHeight ) + "px";
this.ancho_controles += boton_play_pause.offsetWidth;
this.ancho_controles += tiempo.offsetWidth;
this.ancho_controles += duracion.offsetWidth;
this.ancho_controles += pantalla_completa.offsetWidth;
this.ancho_controles += volumen.offsetWidth;
barra.style.width = (this.controles.offsetWidth - 2 * margen - this.ancho_controles) + "px";
barra.sliderseek.style.width = barra.style.width;
this.controles.volumen.maximo = slider.offsetHeight - 6;
this.controles.style.display = "block";
if (!dispositivoMovil)
{
volumen.onmouseover = function() { slider.style.visibility = "visible" };
volumen.onmouseout = function() { slider.style.visibility = "hidden" };
this.actualizaVolumen();
this.pausado = document.createElement("div");
this.pausado.className = "playerMPEPV_pausado";
var play = document.createElement("span");
play.className = "playerMPEPV_pausado_play";
this.pausado.appendChild(play);
this.contenedorVideo.appendChild(this.pausado);
}
};
var MainController = function(playerHTML5) {
this.playerHTML5 = playerHTML5;
this.duracion = -1;
this.firstTime = false;
this.adsActive = false;
this.adsDone = false;
this.fullscreen = false;
this.adPlaying = false;
this.adsController = null;
this.puntoMedio = false;
this.finVideo = false;
if (this.playerHTML5.controles)
{
this.barra = this.playerHTML5.controles.barra;
this.playButton = this.playerHTML5.controles.playpause;
this.boton = -1;
if (this.playerHTML5.adSaltar != null)
{
this.adSkip = this.playerHTML5.adSaltar;
this.adSkip.addEventListener(
'click',
this.bind(this, this.onAdSkip),
false);
}
this.playButton.addEventListener(
'click',
this.bind(this, this.onClick),
false);
this.fullscreenButton = this.playerHTML5.controles.fullscreen;
this.fullscreenButton.addEventListener(
'click',
this.bind(this, this.onFullscreenClick),
false);
this.barra.sliderseek.addEventListener(
'click',
this.bind(this, this.seek),
false);
this.volumen = this.playerHTML5.controles.volumen;
this.tiempo = this.playerHTML5.controles.tiempo;
this.textoDuracion = this.playerHTML5.controles.textoDuracion;
this.volumen.altavoz.addEventListener(
'click',
this.bind(this, this.onAltavozClick),
false);
this.volumen.selectorNivel.addEventListener(
'click',
this.bind(this, this.onSliderClick),
false);
this.volumen.selectorNivel.addEventListener(
'mousemove',
this.bind(this, this.onSliderMouseMove),
false);
this.volumen.selectorNivel.addEventListener(
'mousedown',
this.bind(this, this.onSliderMouseDown),
false);
this.volumen.selectorNivel.addEventListener(
'mouseup',
this.bind(this, this.onSliderMouseUp),
false);
this.volumen.selectorNivel.addEventListener(
mouseWheelEvent,
this.bind(this, this.onMousewheel),
false);
}
this.video = this.playerHTML5.nodoVideo;
this.video.addEventListener(
'timeupdate',
this.bind(this, this.onTimeupdate),
false);
this.video.addEventListener(
'play',
this.bind(this, this.onPlayPausevideo),
false);
this.video.addEventListener(
'pause',
this.bind(this, this.onPlayPausevideo),
false);

this.video.addEventListener(
mouseWheelEvent,
this.bind(this, this.onMousewheel),
false);
if (this.playerHTML5.adContainer != null)
this.adsController = new AdsController(this, this.playerHTML5);
if (this.playerHTML5.pausado)
{
this.video.addEventListener(
'click',
this.bind(this, this.onPause),
false);
this.playerHTML5.pausado.addEventListener(
'mouseover',
this.bind(this, this.onPauseMouseOver),
false);
this.playerHTML5.pausado.addEventListener(
'click',
this.bind(this, this.onPauseClick),
false);
}
this.onClick();
};
MainController.prototype.cargaDatos = function(nuevosDatos)
{
for (var key in nuevosDatos)
this.playerHTML5.datosVideo[key] = nuevosDatos[key];
if (this.playerHTML5.datosVideo.m3u8 && (dispositivoMovil || isMacSafari))
{
this.video.setAttribute("poster", "");
this.video.setAttribute("src", this.playerHTML5.datosVideo.m3u8);
}
else
this.video.setAttribute("src", this.playerHTML5.datosVideo.src);
if(!versionMovil && !MPEP_article)
this.video.play();
if (userAgent.indexOf("android") > -1 && typeof(connectionPEP) != "undefined" && connectionPEP.type == "cellular")
{
this.video.load();
}
if (this.playerHTML5.datosVideo.spriteImg && this.playerHTML5.datosVideo.nSprites > 0 && !dispositivoMovil)
{
var thumbnails = document.createElement("div");
thumbnails.className = 'playerMPEPV_thumbnails';
thumbnails.id = 'thumbnails';
em = document.createElement("div");
em.className = "playerMPEPV_time";
em.appendChild ( document.createTextNode ( "00:00" ) );
thumbnails.appendChild(em);
thumbnails.time = em;
this.barra.appendChild(thumbnails);
thumbnails.style.backgroundImage = 'url(' + this.playerHTML5.datosVideo.spriteImg + ')';
this.playerHTML5.controles.thumbnails = thumbnails;
thumbnails.onmouseover = function(e) { thumbnails.style.visibility = "hidden";
e.stopPropagation();
}
this.playerHTML5.controles.barra.onmouseover = function(e) {
thumbnails.style.visibility = "visible"
}
this.barra.sliderseek.ns = this.playerHTML5.datosVideo.nSprites;
this.barra.sliderseek.onmouseout = function() { thumbnails.style.visibility = "hidden" }
this.barra.sliderseek.onmousemove = function(e) {
var pos = e.layerX  / e.target.offsetWidth;
var n = Math.floor(pos * this.ns);
var fila = 0;
var columna = 0;
if (n < this.ns)
{
fila = Math.floor(n / 10);
columna = n % 10;
thumbnails.style.backgroundPosition = (-1 * columna * 100) + 'px ' + (-1 * fila * 56) + 'px';
thumbnails.style.left = (pos * e.target.offsetWidth - 30 ) + 'px';
}
}
}
if (!dispositivoMovil)
{
if (this.playerHTML5.controles.thumbnails)
{
this.time = this.playerHTML5.controles.thumbnails.time;
this.playerHTML5.controles.barra.sliderseek.addEventListener(
'mousemove',
this.bind(this, this.seekmove),
false);
}
this.volumen.addEventListener(
'mouseout',
this.bind(this, this.volumenMouseOut),
false);
}
}
MainController.prototype.bind = function(thisObj, fn)
{
return function() {
fn.apply(thisObj, arguments);
};
};
MainController.prototype.onPause = function(e)
{
if (!this.playerHTML5.playing || (document.fullScreen || document.mozFullScreen || document.webkitIsFullScreen))
return;
this.playerHTML5.pausado.style.display = "block";
this.pause();
}
MainController.prototype.onPauseMouseOver = function(e)
{
this.playerHTML5.controles.style.display = 'none';
}
MainController.prototype.onPauseClick = function(e)
{
this.resumeAfterAd();
this.adsDone = true;
this.playerHTML5.pausado.style.display = "none";
this.playerHTML5.controles.style.display = 'block';
}
MainController.prototype.onPlayPausevideo = function(e)
{
if (e.type == "pause")
{
if (Math.abs(e.target.duration - e.target.currentTime) < 0.5)
return;
}
this.playerHTML5.marcado._datosMarcado.currentTime = e.target.currentTime;
this.playerHTML5.marcado.marcaComscore(e.type);
}
MainController.prototype.onTimeupdate = function(e)
{
if (isNaN(e.target.duration) || e.target.duration < 0 ||  this.video.currentTime < 0.1)
{
e.preventDefault();
return false;
}
if (!this.firstTime)
{
if (this.playerHTML5.controlesNativosVideo)
{
this.playerHTML5.nodoVideo.setAttribute ( "controls" , "controls" );
}
this.firstTime = true;
this.puntoMedio = false;
this.playerHTML5.nodoVideo.style.display = 'block';
if (this.playerHTML5.controles)
this.playerHTML5.controles.style.visibility = 'visible';
if (this.playerHTML5.adContainer != null)
this.playerHTML5.adContainer.style.display = 'none';
this.duracion = this.playerHTML5.datosVideo.tipoReproduccion != 'streaming' ? e.target.duration : -1;
if (!this.playerHTML5.controlesNativosVideo)
this.actualizaTiempo(-1);
this.playerHTML5.marcado._datosMarcado.ad = "";
this.playerHTML5.marcado._datosMarcado.adCue = "";
this.playerHTML5.marcado._datosMarcado.duracion = this.duracion;
if (typeof(this.playerHTML5.marcado._datosMarcado.adTitle) == "undefined" || this.playerHTML5.marcado._datosMarcado.adTitle.indexOf(":-:") == -1)
this.playerHTML5.marcado._datosMarcado.adTitle = "";
this.playerHTML5.marcado._datosMarcado.uid = this.playerHTML5.datosVideo.uid;
this.playerHTML5.marcado._datosMarcado.seccion_creacion = this.playerHTML5.datosVideo.seccion_creacion;
this.playerHTML5.marcado._datosMarcado.fuente = this.playerHTML5.datosVideo.fuente;
this.playerHTML5.marcado._datosMarcado.tags = this.playerHTML5.datosVideo.tagsIds;
this.playerHTML5.marcado._datosMarcado.autores = this.playerHTML5.datosVideo.autoresIds;
this.playerHTML5.marcado._datosMarcado.currentTime = 0;
this.playerHTML5.marcado.marcaEvento("mediaBegin");
MultimediaReproduciendo(this.playerHTML5.datosVideo.id_video, false);
}
if (this.playerHTML5.marcado._datosMarcado.tipoReproduccion == 'streaming')
return;
if (!this.playerHTML5.controlesNativosVideo && this.playerHTML5.controles)
{
this.tiempo.texto.innerHTML = tiempoBonito( this.video.currentTime );
this.barra.progreso.style.width = (this.video.currentTime * 100  / this.duracion) + "%";
}
if (!this.puntoMedio && Math.abs(this.duracion/2 - this.video.currentTime) < 0.3)
{
this.puntoMedio = true;
this.playerHTML5.marcado._datosMarcado.ad = "";
this.playerHTML5.marcado._datosMarcado.adCue = "";
this.playerHTML5.marcado._datosMarcado.duracion = this.duracion;
this.playerHTML5.marcado._datosMarcado.adTitle = "";
this.playerHTML5.marcado._datosMarcado.uid = this.playerHTML5.datosVideo.uid;
this.playerHTML5.marcado._datosMarcado.seccion_creacion = this.playerHTML5.datosVideo.seccion_creacion;
this.playerHTML5.marcado._datosMarcado.fuente = this.playerHTML5.datosVideo.fuente;
this.playerHTML5.marcado._datosMarcado.tags = this.playerHTML5.datosVideo.tagsIds;
this.playerHTML5.marcado._datosMarcado.autores = this.playerHTML5.datosVideo.autoresIds;
this.playerHTML5.marcado._datosMarcado.currentTime = this.video.currentTime;
this.playerHTML5.marcado.marcaEvento("halfmediaComplete");
}
if (!this.finVideo && Math.abs(this.duracion - this.video.currentTime) < 0.3)
{
this.finVideo = true;
var nn = this;
setTimeout(function(){nn.onContentEnded();},300);
}
};
MainController.prototype.onContentEnded = function() {
this.playerHTML5.marcado._datosMarcado.ad = "";
this.playerHTML5.marcado._datosMarcado.adCue = "";
this.playerHTML5.marcado._datosMarcado.duracion = this.duracion;
this.playerHTML5.marcado._datosMarcado.uid = this.playerHTML5.datosVideo.uid;
this.playerHTML5.marcado._datosMarcado.adTitle = "";
this.playerHTML5.marcado._datosMarcado.seccion_creacion = this.playerHTML5.datosVideo.seccion_creacion;
this.playerHTML5.marcado._datosMarcado.fuente = this.playerHTML5.datosVideo.fuente;
this.playerHTML5.marcado._datosMarcado.tags = this.playerHTML5.datosVideo.tagsIds;
this.playerHTML5.marcado._datosMarcado.autores = this.playerHTML5.datosVideo.autoresIds;
this.playerHTML5.marcado._datosMarcado.currentTime = this.duracion;
this.playerHTML5.marcado.marcaEvento("mediaComplete");
if (this.playerHTML5.datosVideo.publicidad_post_roll)
{
this.adsDone = false;
if (this.adsController)
this.adsController.contentEnded();
}
else
{
this.restart();
}
};
MainController.prototype.restart = function()
{
if (this.playerHTML5.controlesNativosVideo)
this.playerHTML5.nodoVideo.setAttribute ( "controls" , "controls" );
if (this.playerHTML5.controles && this.playerHTML5.controles.thumbnails)
this.playerHTML5.controles.thumbnails.style.visibility = "hidden";
if (this.adPlaying)
{
this.ocultaSaltar();
this.playerHTML5.marcado._datosMarcado.adCurrentTime = this.adsController.currentTime;
this.adsController.adSkip();
this.playerHTML5.nodoVideo.style.display = 'block';
}
else
{
this.playerHTML5.nodoVideo.currentTime = 0.01;
this.playerHTML5.nodoVideo.pause();
this.playerHTML5.playing = false;
this.playerHTML5.marcado._datosMarcado.currentTime = 0;		
}
this.updateChrome();
this.adsDone = false;
this.firstTime = false;
this.finVideo = false;
this.playerHTML5.marcado.eventos = {};
if (typeof(ns_) != "undefined")
this.playerHTML5.marcado._datosMarcado.myStreamingTag = new ns_.StreamingTag({ customerC2: (typeof(_satellite) != "undefined" ? _satellite.getVar("comscore").id : "8671776") });
else
this.playerHTML5.marcado._datosMarcado.myStreamingTag = null;
if (this.adsController)
{
this.adsController.contentCompleteCalled = false;
this.adsController.adPosition = "pre-roll";
}
if (this.playerHTML5.datosVideo.modoSiguientesVideos > 0 )
{
var canal = this.playerHTML5.datosVideo.agrsNombreNormalizado.split(",")[0];
siguientesVideos( canal, this.playerHTML5.datosVideo.id_video);
return;
}
this.playerHTML5.pausado.style.display = "block";
this.playerHTML5.playing = false;
}
MainController.prototype.actualizaTiempo = function(tiempo, ad)
{
if (isIphone)
return;
if (ad)
{
if (tiempo == 0)
this.textoDuracion.texto.innerHTML = "";
else
this.textoDuracion.texto.innerHTML = tiempo.toFixed(0) + " s";
}
else
{
if (!this.playerHTML5.controlesNativosVideo)
{
if (tiempo == -1)
this.textoDuracion.texto.innerHTML = tiempoBonito(this.duracion);
else
this.textoDuracion.texto.innerHTML = tiempoBonito(tiempo);
}
}
}
MainController.prototype.onAltavozClick = function() {
this.playerHTML5.controles.volumen.altavoz.className = this.playerHTML5.controles.volumen.altavoz.className.replace(/ playerMPEPV_silencio/g,"");
if (this.playerHTML5.nodoVideo.volume == 0)
{
if (this.adsActive)
this.adsController.setVolume(this.playerHTML5.volumenActual);
this.playerHTML5.setVolume(this.playerHTML5.volumenActual);
}
else
{
this.playerHTML5.volumenActual = this.playerHTML5.nodoVideo.volume;
this.playerHTML5.controles.volumen.altavoz.className += " playerMPEPV_silencio";
if (this.adsActive)
this.adsController.setVolume(0);
this.playerHTML5.setVolume(0);
}
};
MainController.prototype.volumenMouseOut = function() {
this.boton = -1;
}
MainController.prototype.setVolume = function(volumen) {
if (volumen <0 || volumen > 1)
return;
if (this.adsActive)
this.adsController.setVolume(volumen);
this.playerHTML5.setVolume(volumen);
};
MainController.prototype.seekjs = function(segundo) {
this.video.currentTime = segundo;
if (!this.playerHTML5.playing)
{
this.playerHTML5.play();
this.adsActive = false;
this.adsDone = true;
this.updateChrome();
}
};
MainController.prototype.seek = function(e) {
var pos = this.duracion * e.layerX  / e.target.offsetWidth;
this.video.currentTime = pos;
if (!this.playerHTML5.playing)
{
this.playerHTML5.play();
this.adsActive = false;
this.adsDone = true;
this.updateChrome();
}
};
MainController.prototype.seekmove = function(e) {
var pos = this.video.duration * e.layerX  / e.target.offsetWidth;
this.time.innerHTML = tiempoBonito(pos);
this.time.style.left = (50 - this.time.offsetWidth / 2) + "px";
};
MainController.prototype.onSliderClick = function(event) {
var volumen = 1-((event.offsetY ? event.offsetY : event.layerY)  / event.target.offsetHeight);
this.setVolume(volumen);
};
MainController.prototype.onSliderMouseMove = function(event) {
if (this.boton != 1)
return;
var volumen = 1-((event.offsetY ? event.offsetY : event.layerY) / event.target.offsetHeight);
this.setVolume(volumen);
};
MainController.prototype.onSliderMouseDown = function(event) {
this.boton = event.buttons ? event.buttons : event.which;
};
MainController.prototype.onSliderMouseUp = function(event) {
this.boton = -1
};
MainController.prototype.onMousewheel = function(event) {
var e = window.event || event;
var delta = e.detail ? event.detail : event.wheelDelta;
delta = delta * factorVolumen;
if (delta > 0)
this.setVolume(this.playerHTML5.nodoVideo.volume + 0.05);
else
this.setVolume(this.playerHTML5.nodoVideo.volume - 0.05);
};
MainController.prototype.onClick = function() {
if (this.playerHTML5.adContainer != null && !this.adsDone)
{
this.adsController.initialUserAction();
this.playerHTML5.preloadContent(this.bind(this, this.loadAds));
this.adsDone = true;
return;
}
if (this.adsActive)
{
if (this.adPlaying)
this.adsController.pause();
else
this.adsController.resume();
this.adPlaying = !this.adPlaying;
}
else
{
if (this.playerHTML5.playing)
this.playerHTML5.pause();
else
this.playerHTML5.play();
}
this.updateChrome();
};
MainController.prototype.onFullscreenClick = function() {
if (this.adsActive)
return;
if (this.playerHTML5.nodoVideo.requestFullscreen)
{
this.playerHTML5.nodoVideo.requestFullscreen();
}
else
if (this.playerHTML5.nodoVideo.mozRequestFullScreen)
{
this.playerHTML5.nodoVideo.mozRequestFullScreen();
}
else
if (this.playerHTML5.nodoVideo.webkitRequestFullscreen)
{
this.playerHTML5.nodoVideo.webkitRequestFullscreen();
}
};
MainController.prototype.updateChrome = function() {
if ( !this.playerHTML5.controles)
return;
var activo = (this.adsActive) ? this.adPlaying : this.playerHTML5.playing;
if (activo)
this.playButton.className = "playerMPEPV_boton_play_pause playerMPEPV_boton_pause";
else
this.playButton.className = "playerMPEPV_boton_play_pause playerMPEPV_boton_play";
};
MainController.prototype.resumeAfterAd = function() {
this.adPlaying = false;
this.adsActive = false;
this.playerHTML5.play();
this.updateChrome();
};
MainController.prototype.pause = function() {
if (this.adPlaying)
this.adsController.pause();
if (this.playerHTML5.playing)
this.playerHTML5.pause();
this.adPlaying = false;
this.updateChrome();
};
MainController.prototype.pauseForAd = function() {
this.adsActive = true;
this.adPlaying = false;
this.playerHTML5.pause();
this.updateChrome();
};
MainController.prototype.startAd = function() {
this.adsActive = true;
this.adPlaying  = true;
this.updateChrome();
};
MainController.prototype.adClicked = function() {
this.adsActive = true;
this.adsController.pause();
this.adPlaying = false;
this.updateChrome();
};
MainController.prototype.loadAds = function() {
this.adsController.requestAds(this.playerHTML5.adTagUrl);
};
MainController.prototype.onAdSkip = function() {
this.playerHTML5.marcado._datosMarcado.ad = this.adsController.adInfo;
this.playerHTML5.marcado._datosMarcado.adCue = this.adsController.adPosition;
this.playerHTML5.marcado._datosMarcado.duracion = this.adsController.duracionAd;
this.playerHTML5.marcado._datosMarcado.adTitle = this.adsController.adTitle;
this.playerHTML5.marcado._datosMarcado.uid = this.playerHTML5.datosVideo.uid;
this.playerHTML5.marcado._datosMarcado.seccion_creacion = this.playerHTML5.datosVideo.seccion_creacion;
this.playerHTML5.marcado._datosMarcado.fuente = this.playerHTML5.datosVideo.fuente;
this.playerHTML5.marcado._datosMarcado.tags = this.playerHTML5.datosVideo.tagsIds;
this.playerHTML5.marcado._datosMarcado.autores = this.playerHTML5.datosVideo.autoresIds;
this.playerHTML5.marcado._datosMarcado.adCurrentTime = this.adsController.currentTime;
this.playerHTML5.marcado.marcaEvento("adSkip");
this.ocultaSaltar();
this.adsController.adSkip();
};
MainController.prototype.muestraSaltar = function()
{
if (this.adSkip)
this.adSkip.style.display = 'block';
}
MainController.prototype.ocultaSaltar = function()
{
if (this.adSkip)
this.adSkip.style.display = 'none';
}
var AdsController = function(controller, player) {
this.controller = controller;
this.player = player;
this.contentCompleteCalled = false;
this.duracionAd = 0;
this.adPosition = "pre-roll";
this.adInfo = "dfp";
this.skippable = false;
this.adComplete = false;
this.currentTime = -1;
this.adDisplayContainer = new google.ima.AdDisplayContainer(this.player.adContainer);
this.adsLoader = new google.ima.AdsLoader(this.adDisplayContainer);
if (this.adsLoader)
{
var settings = this.adsLoader.getSettings();
settings.setNumRedirects(5);
}
this.adsManager = null;
this.adsLoader.addEventListener(
google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,
this.onAdsManagerLoaded,
false,
this);
this.adsLoader.addEventListener(
google.ima.AdErrorEvent.Type.AD_ERROR,
this.onAdError,
false,
this);
};
AdsController.prototype.bind = function(thisObj, fn)
{
return function() {
fn.apply(thisObj, arguments);
};
};
AdsController.prototype.initialUserAction = function() {
this.adDisplayContainer.initialize();
};
AdsController.prototype.requestAds = function(adTagUrl) {
adTagUrl = adTagUrl.replace("{random}", String(Math.random()).substr(2,9));
if (this.adPosition == "pre-roll")
adTagUrl = adTagUrl.replace("{cuePointType}", "pre");
else
adTagUrl = adTagUrl.replace("{cuePointType}", "post");
if (this.adsLoader)
{
this.adsLoader.contentComplete();
}
var adsRequest = new google.ima.AdsRequest();
adsRequest.adTagUrl = adTagUrl;
adsRequest.linearAdSlotWidth = this.player.width;
adsRequest.linearAdSlotHeight = this.player.height;
adsRequest.nonLinearAdSlotWidth = this.player.width;
adsRequest.nonLinearAdSlotHeight = this.player.height;
this.adsLoader.requestAds(adsRequest);
if (this.adPosition == "pre-roll")
this.timeoutLoadedStarted = setTimeout(this.resumeOnError.bind(this), 4000);
};
AdsController.prototype.onAdsManagerLoaded = function(adsManagerLoadedEvent) {
this.controller.actualizaTiempo(0,true);
this.adsManager = adsManagerLoadedEvent.getAdsManager(
this.player.nodoVideo);
this.processAdsManager(this.adsManager);
};
AdsController.prototype.processAdsManager = function(adsManager) {
adsManager.addEventListener(
google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,
this.onContentPauseRequested,
false,
this);
adsManager.addEventListener(
google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,
this.onContentResumeRequested,
false,
this);
adsManager.addEventListener(
google.ima.AdErrorEvent.Type.AD_ERROR,
this.onAdError,
false,
this);
var events = [google.ima.AdEvent.Type.ALL_ADS_COMPLETED,
google.ima.AdEvent.Type.CLICK,
google.ima.AdEvent.Type.COMPLETE,
google.ima.AdEvent.Type.LOADED,
google.ima.AdEvent.Type.PAUSED,
google.ima.AdEvent.Type.RESUMED,
google.ima.AdEvent.Type.STARTED
];
for (var index in events)
{
adsManager.addEventListener(
events[index],
this.onAdEvent,
false,
this);
}
var initWidth, initHeight;
if (this.controller.fullscreen)
{
initWidth = this.controller.fullscreenWidth;
initHeight = this.controller.fullscreenHeight;
}
else
{
if(!MPEP_responsive){
initWidth = this.player.width;
initHeight = this.player.height;
}else{
initHeight = this.player.datosVideo.altoPlayer;
initWidth = this.player.datosVideo.anchoPlayer;
}
}
adsManager.init(
initWidth,
initHeight,
google.ima.ViewMode.NORMAL);
adsManager.start();
};
AdsController.prototype.pause = function() {
if (this.adsManager)
this.adsManager.pause();
clearInterval(this.intervalTimmer);
};
AdsController.prototype.resume = function() {
if (this.adsManager) {
this.adsManager.resume();
}
};
AdsController.prototype.setVolume = function(volumen) {
if (this.adsManager)
{
this.adsManager.setVolume(volumen);
this.player.actualizaVolumen();
}
};
AdsController.prototype.onContentPauseRequested = function() {
this.controller.pauseForAd();
};
AdsController.prototype.onContentResumeRequested = function() {
if (this.adPosition == 'post-roll')
return;
clearInterval(this.intervalTimmer);
if (!this.contentCompleteCalled)
this.controller.resumeAfterAd();
};
AdsController.prototype.onAdEvent = function(adEvent) {
switch (adEvent.type)
{
case google.ima.AdEvent.Type.CLICK:
clearInterval(this.intervalTimmer);
this.controller.adClicked();
break;
case google.ima.AdEvent.Type.STARTED:
clearTimeout(this.timeoutLoadedStarted);
var ad = adEvent.getAd();
if (ad.isLinear())
{
if (this.player.adContainer != null)
{
this.player.adContainer.style.display = 'block';
if (this.player.controles)
{
this.player.controles.barra.style.visibility = 'hidden';
this.player.controles.fullscreen.style.visibility = 'hidden';
this.player.controles.tiempo.texto.innerHTML = (LANG_MSG[LANG].publicidad).toUpperCase();
if (isIpad)
this.player.controles.volumen.style.visibility = 'hidden';
}
if (dispositivoMovil || this.player.controlesNativosVideo)
{
this.player.contenedorVideo.className = this.player.contenedorVideo.className.replace(/ playerMPEPV_touch_\w*/g,"");
this.player.contenedorVideo.className += " playerMPEPV_touch_publicidad";
this.player.nodoVideo.removeAttribute("controls");
}
this.controller.startAd();
MultimediaReproduciendo(this.player.datosVideo.id_video, false);
this.duracionAd = -2;
this.adComplete = false;
this.intervalTimmer = setInterval( this.onProgress.bind(this), 300);
}
}
break;
case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:
this.player.nodoVideo.style.display = 'block';
if (this.player.controles)
{
this.player.controles.style.visibility = 'visible';
this.player.controles.barra.style.visibility = 'visible';
this.player.controles.fullscreen.style.visibility = 'visible';
this.player.controles.tiempo.texto.innerHTML = '00:00';
}
this.player.adContainer.style.display = 'none';
this.controller.adPlaying = false;
this.controller.adsActive = false;
this.controller.actualizaTiempo(-1);
this.controller.ocultaSaltar()
if (this.adComplete)
{
this.adComplete = false;
this.player.marcado._datosMarcado.duracion = this.duracionAd;
this.player.marcado._datosMarcado.ad = this.adInfo;
this.player.marcado._datosMarcado.adCue = this.adPosition;
this.player.marcado._datosMarcado.adTitle = this.adTitle;
this.player.marcado._datosMarcado.uid = this.player.datosVideo.uid;
this.player.marcado._datosMarcado.seccion_creacion = this.player.datosVideo.seccion_creacion;
this.player.marcado._datosMarcado.fuente = this.player.datosVideo.fuente;
this.player.marcado._datosMarcado.tags = this.player.datosVideo.tagsIds;
this.player.marcado._datosMarcado.autores = this.player.datosVideo.autoresIds;
this.player.marcado._datosMarcado.adCurrentTime = this.duracionAd;
this.player.marcado.marcaEvento("adComplete");
}
else
{
this.controller.onAdSkip();
}
if (this.adPosition == "post-roll")
{
this.adPosition = 'pre-roll';
this.controller.restart();
}
clearInterval(this.intervalTimmer);
if (dispositivoMovil || this.player.controlesNativosVideo)
{
this.player.contenedorVideo.className = this.player.contenedorVideo.className.replace(/ playerMPEPV_touch[\w_]*/g,"");
this.player.contenedorVideo.className += " playerMPEPV_touch";
this.player.nodoVideo.setAttribute ( "controls" , "controls" );
}
break;
case google.ima.AdEvent.Type.PAUSED:
clearInterval(this.intervalTimmer);
this.player.marcado._datosMarcado.adCurrentTime = this.currentTime;
this.player.marcado.marcaComscore("adPaused");
break;
case google.ima.AdEvent.Type.RESUMED:
this.intervalTimmer = setInterval( this.onProgress.bind(this), 300);
MultimediaReproduciendo(this.player.datosVideo.id_video, false);
this.player.marcado._datosMarcado.adCurrentTime = this.currentTime;
this.player.marcado.marcaComscore("adResumed");
break;
case google.ima.AdEvent.Type.LOADED:
clearTimeout(this.timeoutLoadedStarted);
var ad = adEvent.getAd();
if ((typeof(ad.isSkippable()) != "undefined" && ad.isSkippable()) || ad.getTitle().toLowerCase().indexOf('apple_no_skip_2017') > -1)
this.skippable = true;
this.adTitle = ad.getAdId() + " - " + ad.getTitle();
if (!ad.isLinear()) {
this.controller.resumeAfterAd();
return;
}
if (ad.getWrapperAdIds().length == 0)
this.adInfo = "dfp";
else
this.adInfo = "tercero";
if (this.player.controles && this.player.controles.thumbnails)
this.player.controles.thumbnails.style.visibility = "hidden";
break;
}
};
AdsController.prototype.resumeOnError = function()
{
if (this.adsManager)
this.adsManager.stop();
else
this.onContentResumeRequested();
}
AdsController.prototype.onProgress = function()
{
if (this.adsManager.getRemainingTime() <= 0)
return;
if (!this.controller.adPlaying || this.duracionAd <= 1 || this.duracionAd >99 )
{
this.duracionAd = this.adsManager.getRemainingTime();
if (this.player.controles)
this.player.controles.style.visibility = 'visible';
this.player.marcado._datosMarcado.duracion = this.duracionAd;
this.player.marcado._datosMarcado.ad = this.adInfo;
this.player.marcado._datosMarcado.adCue = this.adPosition;
this.player.marcado._datosMarcado.adTitle = this.adTitle;
this.player.marcado._datosMarcado.uid = this.player.datosVideo.uid;
this.player.marcado._datosMarcado.seccion_creacion = this.player.datosVideo.seccion_creacion;
this.player.marcado._datosMarcado.fuente = this.player.datosVideo.fuente;
this.player.marcado._datosMarcado.tags = this.player.datosVideo.tagsIds;
this.player.marcado._datosMarcado.autores = this.player.datosVideo.autoresIds;
this.player.marcado._datosMarcado.adCurrentTime = 0;
this.player.marcado.marcaEvento("adStart");
return;
}
this.currentTime = this.duracionAd - this.adsManager.getRemainingTime();
if (this.adPosition == "pre-roll" )
{
if (!isIphone && !this.skippable && this.adsManager.getRemainingTime() > 2 && this.adsManager.getRemainingTime() < this.duracionAd - 7)
{
this.controller.muestraSaltar();
}
if (isIphone  && this.adsManager.getRemainingTime() < this.duracionAd - 21)
{
clearInterval(this.intervalTimmer);
this.adsManager.stop();
}
}
if (!isIphone && this.adsManager.getRemainingTime() > 1)
this.controller.actualizaTiempo(this.adsManager.getRemainingTime(), true);
if (this.adsManager.getRemainingTime() < 0.5)
this.adComplete = true;
};
AdsController.prototype.onAdError = function(adErrorEvent) {
var adError = adErrorEvent.getError();
this.player.marcado._datosMarcado.adCue = this.adPosition;
this.player.marcado._datosMarcado.ad = this.adInfo;
this.player.marcado._datosMarcado.uid = this.player.datosVideo.uid;
this.player.marcado._datosMarcado.seccion_creacion = this.player.datosVideo.seccion_creacion;
this.player.marcado._datosMarcado.fuente = this.player.datosVideo.fuente;
this.player.marcado._datosMarcado.adCurrentTime = -1;
this.player.marcado._datosMarcado.adTitle = (this.adTitle ? this.adTitle : "error ad_load")+ ":-:" + adError.getErrorCode() + (adError.getErrorCode() != adError.getVastErrorCode() ? ("-" + adError.getVastErrorCode() ): "");
this.player.marcado.marcaEvento("adError");
this.player.nodoVideo.style.display = 'block';
if (this.player.controles)
this.player.controles.style.visibility = 'visible';
this.player.adContainer.style.display = 'none';
if (dispositivoMovil || this.player.controlesNativosVideo)
{
this.player.contenedorVideo.className = this.player.contenedorVideo.className.replace(/ playerMPEPV_touch[\w_]+/g,"");
this.player.contenedorVideo.className += " playerMPEPV_touch";
this.player.nodoVideo.setAttribute ( "controls" , "controls" );
}
if (this.adPosition == 'post-roll')
{
this.adPosition = 'pre-roll';
this.controller.restart();
}
else
{
clearTimeout(this.timeoutLoadedStarted);
this.controller.resumeAfterAd();
}
if (this.adsManager) {
this.adsManager.destroy();
}
this.controller.adPlaying = false;
this.controller.adsActive = false;
};
AdsController.prototype.resize = function(width, height) {
if (this.adsManager)
this.adsManager.resize(width, height, google.ima.ViewMode.FULLSCREEN);
};
AdsController.prototype.contentEnded = function() {
if (!dispositivoMovil)
{
this.adPosition = 'post-roll';
this.contentCompleteCalled = true;
this.controller.adsActive = false;
this.duracionAd = -2;
this.controller.onClick();
}
else
this.controller.restart();
};
AdsController.prototype.adSkip = function() {
clearInterval(this.intervalTimmer);
this.adsManager.stop();
this.controller.adsActive = false;
this.controller.adPlaying = false;
};
function EPET_VideoPlayerGeobloqueado(idReferencia, ancho, alto, fotograma, idDivContenedor)
{
EPET_VideoPlayerBloqueado(idReferencia, ancho, alto, fotograma, '0', idDivContenedor);
}
function EPET_VideoPlayerBloqueado(idReferencia, ancho, alto, fotograma, causaBloqueo, idDivContenedor, esAudio)
{
if ( !css_videos_cargado)
{
css_videos_cargado = true;
var css = document.createElement("link");
css.type = "text/css";
css.rel = "stylesheet";
css.href = css_multimedia;
document.getElementsByTagName("head")[0].appendChild(css);
if(versionMovil)
{
var css_movil = document.createElement("link");
css_movil.type = "text/css";
css_movil.rel = "stylesheet";
css_movil.href = css_multimedia_movil;
document.getElementsByTagName("head")[0].appendChild(css_movil);
}
}
var id_div_ReproductorVideo;
var idImage = "img_" + idReferencia;
var texto_error;
switch(String(causaBloqueo)) {
case "0":
texto_error = esAudio ? LANG_MSG[LANG].audio_geobloqueado : LANG_MSG[LANG].geobloqueado;
break;
case "1":
texto_error = esAudio ? LANG_MSG[LANG].audio_aun_no_disponible : LANG_MSG[LANG].aun_no_disponible;
break;
case "2":
texto_error = esAudio ? LANG_MSG[LANG].audio_no_disponible : LANG_MSG[LANG].no_disponible;
break;
case "3":
texto_error = LANG_MSG[LANG].actualizar_plugin;
break;
case "4":
texto_error = LANG_MSG[LANG].bloqueado;
break;
case "-1":
case "-2":
texto_error = esAudio ? LANG_MSG[LANG].audio_no_encontrado : LANG_MSG[LANG].no_encontrado;
break;
default :
texto_error = " Error Cod. " + String(causaBloqueo);
break;
}
var estiloMSJ = "";
if (esAudio)
estiloMSJ = 'style="bottom:5px"';
if (typeof(idDivContenedor) == "undefined" )
{
id_div_ReproductorVideo = "VideoPlayer_" + String(Math.random()).substr(2,9);
document.write('<div id="' + id_div_ReproductorVideo + '"></div>');
}
else
id_div_ReproductorVideo = idDivContenedor;
if(MPEP_article && !versionMovil){
var ancho_ref = "100%";
var alto_ref = (typeof(document.getElementById(id_div_ReproductorVideo).parentNode) != "undefined" && document.getElementById(id_div_ReproductorVideo).parentNode.offsetHeight > 0)? document.getElementById(id_div_ReproductorVideo).parentNode.offsetHeight: 390;
alto = (alto_ref) + "px";
ancho = ancho_ref;
document.getElementById(id_div_ReproductorVideo).innerHTML = '<div class="video_previa video_no_disponible s-pr" id="' + idImage +
'"><div class="cnt-media-msg s-pa"><div class="ntc-media-msg"><p class="icon-astv icon ico-msg-video"></p><span class="s-tcenter ntc-media-msg-txt">'+texto_error+'</span></div></div><img src="' +
fotograma + '" width="' + ancho + '" height="' + alto + '"/></div>';
}else if(MPEP_responsive){
document.getElementById(id_div_ReproductorVideo).innerHTML = '<div class="video_previa video_no_disponible s-pr" id="' + idImage +
'"><div class="cnt-media-msg s-pa"><div class="ntc-media-msg"><p class="icon-astv icon ico-msg-video"></p><span class="s-tcenter ntc-media-msg-txt">'+texto_error+'</span></div></div><img src="' +
fotograma + '" width="100%"/></div>';
}else{
document.getElementById(id_div_ReproductorVideo).innerHTML = '<div class="video_previa video_no_disponible s-pr" id="' + idImage +
'"><div class="cnt-media-msg s-pa"><div class="ntc-media-msg"><p class="icon-astv icon ico-msg-video"></p><span class="s-tcenter ntc-media-msg-txt">'+texto_error+'</span></div></div><img src="' +
fotograma + '" width="' + ancho + '" height="' + alto + '"/></div>';
}
}
function EPET_VideoPlayerBrightcoveExterno(ancho, alto, idVideo, playerKey )
{
var idDiv = "div_" + idVideo;
document.write('<div id="' + idDiv + '"></div>');
var bcParams = {};
bcParams.playerKey = playerKey;
bcParams.isVid = "true";
bcParams.isUI = "true";
bcParams.dynamicStreaming = "true";
bcParams.width =  ancho ;
bcParams.height = alto;
bcParams.bgcolor = "#000000";
bcParams.autoStart = "false";
bcParams.videoSmoothing = "true";
bcParams.forceHTML = "true";
var idIframe = "Iframe_" + idVideo;
var codigoHTML = '<html>\n<head><style type="text/css"> body { margin: 0px;}</style>\n' +
'<script language="JavaScript" type="text/javascript" src="' + protocolUrl + '//admin.brightcove.com/js/BrightcoveExperiences.js"></scr' + 'ipt>\n<\head>\n' +
'<body>\n'+
'<object id="Video_' + idVideo + '" class="BrightcoveExperience">\n';
for(var p in bcParams)
{
codigoHTML += '<param name="' + p + '" value="' + bcParams[p] + '" />\n';
}
codigoHTML += '<param name="@videoPlayer" value="' + idVideo + '" />\n';
codigoHTML += '</object>\n' +
'</body>\n</html>\n';
EPETCreaIframe(idIframe, bcParams.width, bcParams.height, "no", 0, idDiv, codigoHTML);
}
function tiempoBonito(tiempo)
{
if ( tiempo == -1 )
return("--:--")
else
if (tiempo == 0)
return("00:00")
tiempo = parseInt(tiempo);
var horas = parseInt ( tiempo / 3600 );
var minutos = parseInt ( (tiempo - horas * 3600) / 60 );
var segundos = tiempo - horas * 3600 - minutos * 60;
if ( minutos < 10 ) minutos = "0" + minutos;
if ( segundos < 10 ) segundos = "0" + segundos;
if (tiempo > 3599)
return horas+":"+minutos+":"+segundos;
else
return minutos+":"+segundos;
};
var mouseWheelEvent;
var factorVolumen;
if (/Firefox/i.test(navigator.userAgent))
{
mouseWheelEvent =  "DOMMouseScroll";
factorVolumen = -1;
}
else
{
mouseWheelEvent =  "mousewheel";
factorVolumen = 1;
}
function wheel(event) {
if (event.target && ((event.target.className && event.target.className.indexOf("MPEP") > -1) || (event.target.parentNode && event.target.parentNode.className && event.target.parentNode.className.indexOf("MPEP") > -1)))
{
event.preventDefault();
event.stopPropagation();
}
}
function EPETUtils_calcPosition(obj, attr) {
var val=0;
while (obj) {
val+=obj[attr];
obj=obj.offsetParent
}
return val
}
function EPETUtils_calcAbsPosition(el) {
if (document.documentElement.getBoundingClientRect && el.getBoundingClientRect) {
var box = el.getBoundingClientRect();
var rootNode;
if (el.ownerDocument) {
rootNode = el.ownerDocument;
} else {
rootNode = document;
}
return [box.left + Math.max(rootNode.documentElement.scrollLeft, rootNode.body.scrollLeft),
box.top + Math.max(rootNode.documentElement.scrollTop, rootNode.body.scrollTop)];
} else {
var pos = [el.offsetLeft, el.offsetTop];
var parentNode = el.offsetParent;
var accountForBody = (isSafari &&
el.style.position == 'absolute' &&
el.offsetParent == el.ownerDocument.body);
if (parentNode != el) {
while (parentNode) {
pos[0] += parentNode.offsetLeft;
pos[1] += parentNode.offsetTop;
if (!accountForBody && isSafari &&
parentNode.style.position == 'absolute' ) {
accountForBody = true;
}
parentNode = parentNode.offsetParent;
}
}
if (accountForBody) {
pos[0] -= el.ownerDocument.body.offsetLeft;
pos[1] -= el.ownerDocument.body.offsetTop;
}
if (el.parentNode) {
parentNode = el.parentNode;
var ROOT_TAG = /^body|html$/i;
while ( parentNode.tagName && !ROOT_TAG.test(parentNode.tagName) ) {
if (parentNode.style.display.search(/^inline|table-row.*$/i)) {
pos[0] -= parentNode.scrollLeft;
pos[1] -= parentNode.scrollTop;
}
parentNode = parentNode.parentNode;
}
}
return pos;
}
}
function EPETUtils_calcAbsPositionV2(el) {
if (document["documentElement"]["getBoundingClientRect"]) {
var scrollLeft, scrollTop, box, doc,
off1, off2, mode, bLeft, bTop,
xy = false;
if (el.style.display != 'none' && el["getBoundingClientRect"]) {
try {
box = el["getBoundingClientRect"]();
} catch (e) {
return ([0,0]);
}
doc = el["ownerDocument"];
scrollLeft = Math.max(doc["documentElement"].scrollLeft, doc.body.scrollLeft);
scrollTop  = Math.max(doc["documentElement"].scrollTop, doc.body.scrollTop);
xy = [Math.round(box["left"]), Math.round(box["top"])];
if (isIE && isIE < 8) {
off1 = 2;
off2 = 2;
mode = doc["compatMode"];
if (window["getComputedStyle"]) {
bLeft = doc["documentElement"]["defaultView"]["getComputedStyle"](doc["documentElement"], null)["borderLeftWidth"];
bTop  = doc["documentElement"]["defaultView"]["getComputedStyle"](doc["documentElement"], null)["borderTopWidth"];
} else if (doc["documentElement"]["currentStyle"]) {
bLeft = doc["documentElement"]["clientLeft"];
bTop  = doc["documentElement"]["clientTop"];
}
if (isIE == 6) {
if (mode != "BackCompat" && mode != "CSS1Compat") {
off1 = 0;
off2 = 0;
}
}
if ((mode == "BackCompat" || mode == "CSS1Compat")) {
if (bLeft != "medium") {
off1 = parseInt(bLeft, 10);
}
if (bTop != "medium") {
off2 = parseInt(bTop, 10);
}
}
xy[0] -= off1;
xy[1] -= off2;
}
if ((scrollTop || scrollLeft)) {
xy[0] += scrollLeft;
xy[1] += scrollTop;
}
xy[0] = Math.round(xy[0]);
xy[1] = Math.round(xy[1]);
} else {
xy = [0,0];
}
return xy;
} else {
var doc, docScrollLeft, docScrollTop,
scrollTop, scrollLeft,
bCheck,
xy = false,
parentNode = el;
if (el.style.display != 'none') {
xy = [el["offsetLeft"], el["offsetTop"]];
doc = el["ownerDocument"];
docScrollLeft = Math.max(doc["documentElement"].scrollLeft, doc.body.scrollLeft);
docScrollTop = Math.max(doc["documentElement"].scrollTop, doc.body.scrollTop);
bCheck = ((isGecko || isSafari > 519) ? true : false);
while ((parentNode = parentNode["offsetParent"])) {
xy[0] += parentNode["offsetLeft"];
xy[1] += parentNode["offsetTop"];
if (bCheck) {
var t = 0, l = 0;
if (window["getComputedStyle"]) {
t = parseInt(parentNode["ownerDocument"]["defaultView"]["getComputedStyle"](parentNode, null)["borderTopWidth"], 10) || 0;
l = parseInt(parentNode["ownerDocument"]["defaultView"]["getComputedStyle"](parentNode, null)["borderLeftWidth"], 10) || 0;
} else if (parentNode["currentStyle"]) {
t = parseInt(parentNode["clientTop"], 10) || 0;
l = parseInt(parentNode["clientLeft"], 10) || 0;
}
if (isGecko) {
if (/^t(?:able|d|h)$/i.test(parentNode["tagName"])) {
t = 0;
l = 0;
}
}
xy[0] += l;
xy[1] += t;
}
}
if (el.style.position != "fixed") {
parentNode = el;
while ((parentNode = parentNode["parentNode"]) && parentNode["tagName"]) {
scrollTop = parentNode["scrollTop"];
scrollLeft = parentNode["scrollLeft"];
if (scrollTop || scrollLeft) {
xy[0] -= scrollLeft;
xy[1] -= scrollTop;
}
}
xy[0] += docScrollLeft;
xy[1] += docScrollTop;
} else {
if (isOpera) {
xy[0] -= docScrollLeft;
xy[1] -= docScrollTop;
} else if (isSafari || isGecko) {
xy[0] += docScrollLeft;
xy[1] += docScrollTop;
}
}
xy[0] = Math.round(xy[0]);
xy[1] = Math.round(xy[1]);
} else {
xy[0] = 0;
xy[1] = 0;
}
}
return xy;
}
function EPETUtils_posicionarScrollEnPagina(posY) {
if (typeof document.documentElement.scrollTop != "undefined") {
document.documentElement.scrollTop = parseInt(posY);
}
if (typeof document.body.scrollTop != "undefined" && !isOpera) {
document.body.scrollTop = parseInt(posY);
}
}
function EPETUtils_windowOpen(url, nombreVentana, attrs) {
var nuevoNombre = nombreVentana;
if (nuevoNombre == '') {
nuevoNombre = Math.random();
}
var _window = window.open(url, nombreVentana, attrs);
}
function EPETUtils_IFrameRequest() {
var reqCount = 0;
this.readyState = 0;
this.status = 0;
this.responseText = "";
reqCount++;
this.req_id = reqCount;
}
EPETUtils_IFrameRequest.prototype = {
open: function(protocol, url, async) {
this.protocol = protocol;
this.url      = url;
},
onreadystatechange: function() { },
send: function(postBody) {
var self = this;
if (this.protocol.toUpperCase()=='POST') {
this.url = this.url + "&" + postBody;
}
var IFrameDoc = document.createElement('iframe');
IFrameDoc.setAttribute('id', 'req'+this.req_id);
IFrameDoc.setAttribute('name', 'req'+this.req_id);
IFrameDoc.style.width = "0";IFrameDoc.style.height = "0";IFrameDoc.style.border = "0";
document.body.appendChild(IFrameDoc);
try {
IFrameDoc.src = this.url;
}catch(e){
return false;
}
this.readyState = 1; this.onreadystatechange();
setTimeout(function(){self.IFht(4);}, 4);
},
overrideMimeType: function() { },
getResponseHeader: function (name) { return ''; },
setRequestHeader: function (name, data) { },
IFht: function (d) {
var self=this;
var el=document.getElementById('req'+self.req_id);
if (el.readyState=='complete') {
self.responseText = document.frames['req'+self.req_id].document.body.innerHTML.replace(/[\n\r]+/ig, "");
el.parentNode.removeChild(el);
self.status = 200;
self.readyState = 4;
self.onreadystatechange();
}else{
d*=1.5;
setTimeout(function(){self.IFht(d);},d);
}
}
};
function EPETUtils_makeHttpRequest(callbackFunction, url, postData, contentType) {
if (typeof url == "undefined") { return; }
if (typeof contentType =="undefined") { contentType = 'application/x-www-form-urlencoded'; }
var EPETUtils_xmlHttpRequest = EPETUtils_createHttpRequestObj(contentType);
if (!EPETUtils_xmlHttpRequest) return;
EPETUtils_xmlHttpRequest.onreadystatechange = function () {
if (EPETUtils_xmlHttpRequest.readyState != 4) return;
callbackFunction(EPETUtils_xmlHttpRequest);
}
EPETUtils_xmlHttpRequest.open('POST', url, true);
EPETUtils_xmlHttpRequest.setRequestHeader('Content-type', contentType);
EPETUtils_xmlHttpRequest.send(postData);
}
function EPETUtils_makeHttpRequestGet (callbackFunction, url, contentType) {
if (typeof url == "undefined") { return; }
if (typeof contentType =="undefined" ) { contentType = 'application/x-www-form-urlencoded'; }
var EPETUtils_xmlHttpRequest = EPETUtils_createHttpRequestObj(contentType);
if (!EPETUtils_xmlHttpRequest) return;
EPETUtils_xmlHttpRequest.onreadystatechange = function () {
if (EPETUtils_xmlHttpRequest.readyState != 4) return;
callbackFunction(EPETUtils_xmlHttpRequest);
}
EPETUtils_xmlHttpRequest.open('GET', url, true);
EPETUtils_xmlHttpRequest.setRequestHeader('Content-type', contentType);
EPETUtils_xmlHttpRequest.send(null);
}
function EPETUtils_createHttpRequestObj(contentType) {
var httpRequest;
if (window.XMLHttpRequest) {
httpRequest = new XMLHttpRequest();
if (httpRequest.overrideMimeType && contentType) {
httpRequest.overrideMimeType(contentType);
}
}else if (window.ActiveXObject) {
try {
httpRequest = new ActiveXObject("Msxml2.XMLHTTP");
}
catch (e) {
try {
httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
}
catch (e) {
try {
httpRequest = new EPETUtils_IFrameRequest();
}
catch (e) {
httpRequest = false;
}
}
}
}
return httpRequest;
}
function marcadoAmpliaFoto(tituloPagina, fotoUrl)
{
if (typeof(launchAjaxOMN) == "function")
{
tituloPagina = tituloPagina.replace(/'|"|\|/g, "");
launchAjaxOMN("39|46", tituloPagina + "|" + fotoUrl, "event76");
}
}
function EPETtrackNewInfoFromAJAX()
{
var rndPXLAJAX = parseInt(Math.random()*10000000);
var imgMMDAJAX = new Image(1,1);
imgMMDAJAX.src = "/pxlctl.gif?"+rndPXLAJAX;
if (typeof(launchAjaxOMN) == "function" && typeof(omnEvars) != "undefined" && typeof(omnInfo) != "undefined" &&  typeof(omnEvents) != "undefined" )
{
launchAjaxOMN(omnEvars, omnInfo, omnEvents);
}
}
function EPETtrackWidgetNewInfoFromAJAX()
{
var rndPXLAJAX = parseInt(Math.random()*10000000);
var imgMMDAJAX = new Image(1,1);
imgMMDAJAX.src = "/pxlctl.gif?"+rndPXLAJAX;
}

function EPETCreaIframe(id, ancho, alto, scroll, borde, div, code)
{
var iframe=document.createElement("iframe");
iframe.setAttribute("id",id);
iframe.setAttribute("width",ancho);
iframe.setAttribute("height",alto);
iframe.setAttribute("scrolling", scroll);
iframe.frameBorder = borde;
document.getElementById(div).innerHTML = "";
document.getElementById(div).appendChild(iframe);
iFrDoc = document.getElementById(id).contentWindow.document || document.getElementById(id).contentDocument.document;
iFrDoc.write(code);
iFrDoc.close();
}

function EPETaddClass(id, name) {
var obj;
if ( typeof(id) == 'string' ) {
if ( document.getElementById(id) ) {
obj = document.getElementById(id);
} else {
return true;
}
} else if ( typeof(id) == 'object' ) {
obj = id;
} else {
return true;
}
var estilo = obj.className;
estilo += ' ' + name;
obj.className = estilo;
}
function EPETremoveClass(id, name) {
var obj;
if ( typeof(id) == 'string' ) {
if ( document.getElementById(id) ) {
obj = document.getElementById(id);
} else {
return true;
}
} else if ( typeof(id) == 'object' ) {
obj = id;
} else {
return true;
}
var estilo = obj.className;
var Exp = new RegExp('\\s*'+name+'(\\s|$)','g');
estilo = estilo.replace(Exp, ' ');
obj.className = estilo;
}
function EPETUtils_userSelectOff() {
if (isGecko) { document.body.style.MozUserSelect = "none"; }
if (isSafari) { document.body.style.KhtmlUserSelect = "none"; }
if (isIE) { document.body.unselectable = "on"; }
document.body.style.userSelect = "none";
}
function EPETUtils_userSelectOn() {
if (isGecko) { document.body.style.MozUserSelect = "text"; }
if (isSafari) { document.body.style.KhtmlUserSelect = "text"; }
if (isIE) { document.body.unselectable = "off"; }
document.body.style.userSelect = "text";
}
function EPETUtils_fullEncodeURIComponent(str) {
str = encodeURIComponent(str)
return (str.replace(/'/g, "%27"));
}
function EPETnewsNotify() {
EPETUtils_makeHttpRequestGet ( function() { return true; }, '/notificarelacionadas', '');
}
function EPETgetVScrollPosition()
{
if (typeof(document.documentElement.scrollTop) != "undefined" && document.documentElement.scrollTop)
return document.documentElement.scrollTop;
else
if (typeof(window.pageYOffset) != "undefined")
return window.pageYOffset;
else
return 0;
}

function EPETBrowserDims()
{
var viewportwidth = 0;
var viewportheight = 0;
if (typeof window.innerWidth != 'undefined') {
viewportwidth = window.innerWidth,
viewportheight = window.innerHeight
}
else if (typeof document.documentElement != 'undefined'
&& typeof document.documentElement.clientWidth !=
'undefined' && document.documentElement.clientWidth != 0) {
viewportwidth = document.documentElement.clientWidth,
viewportheight = document.documentElement.clientHeight
}
else {
viewportwidth = document.getElementsByTagName('body')[0].clientWidth,
viewportheight = document.getElementsByTagName('body')[0].clientHeight
}
if (dispositivoMovil && typeof document.documentElement != 'undefined' && typeof document.documentElement.clientWidth != 'undefined' && document.documentElement.clientWidth != 0)
{
viewportwidth = document.documentElement.clientWidth;
viewportheight = document.documentElement.clientHeight;
}
return {"ancho" : viewportwidth , "alto" : viewportheight};
}
function EPETalternacampos(id_campo1, estilo_campo1, id_campo2, estilo_campo2) {
if (document.getElementById(id_campo1)) {
document.getElementById(id_campo1).style.display = estilo_campo1;
}
if (document.getElementById(id_campo2)) {
document.getElementById(id_campo2).style.display = estilo_campo2;
}
}
function teclaPulsada(key)
{
var keycode;
if (window.event)
keycode = window.event.keyCode;
else
if (key)
keycode = key.which;
if (keycode == 27)
cerrarTelonMultimedia();
}
function teclaTelonEvent(e)
{
if (e.keyCode == 27 ){
cerrarTelonMultimedia();
}
}

function f_pinta_datos(nick, datosUsuario, idVentana, boton) {
var nombreCompleto = nick;
var descripcionUsuario = '';
var fotoUsuario = '';
if ( (datosUsuario.perfilesUsuarios) && (datosUsuario.perfilesUsuarios[nick]) )  {
datosUsuario = datosUsuario.perfilesUsuarios[nick];
var nombreUsuario    = datosUsuario.nombre;
var apellidosUsuario = datosUsuario.apellidos;
var descripcionUsuario = datosUsuario.descripcion;
var fotoUsuario = datosUsuario.pathfoto;
if (apellidosUsuario != '') {
nombreCompleto = apellidosUsuario + ', ' + nombreUsuario;
}
else {
if (nombreUsuario != '') {
nombreCompleto = nombreUsuario;
}
}
}
var contenido_html = '';
contenido_html = contenido_html + '<div class="encabezado estirar">';
contenido_html = contenido_html + '<a onclick="javascript:document.getElementById(\'' + idVentana + '\').style.display=\'none\';" title="' + LANG_MSG[LANG].cerrar + '" class="autor" href="javascript:void(0);">' + nombreCompleto + '</a>';
contenido_html = contenido_html + '<a title="' +  LANG_MSG[LANG].ver_perfil_completo + '" href="' + protocolUrl + '//eskup.as.com/' + nick + '" target="_blank">' + LANG_MSG[LANG].ver_perfil_eskup + ' &raquo;</a>';
contenido_html = contenido_html + '<a onclick="javascript:document.getElementById(\'' + idVentana + '\').style.display=\'none\';" title="' + LANG_MSG[LANG].cerrar + '" class="cerrar" href="javascript:void(0);"></a>';
contenido_html = contenido_html + '</div><!-- === .encabezado === -->';
contenido_html = contenido_html + '<div class="contenido estirar">';
if (fotoUsuario != '' ) {
contenido_html = contenido_html + '<div class="foto"><img width="100" height="100" src="' + fotoUsuario + '" alt="' + LANG_MSG[LANG].avatar + '"></div><!-- === .foto === -->';
}
contenido_html = contenido_html + '<p>' + descripcionUsuario + '</p>';
contenido_html = contenido_html + '</div><!-- === .contenido === -->';
var posX = boton.offsetLeft;
var posY = boton.offsetTop;
if (posY < 0) {
posY = 0;
}
var panel = document.getElementById(idVentana);
panel.innerHTML = contenido_html;
panel.style.display = 'block';
panel.style.top  = posY + 'px';
panel.style.left = posX + 'px';
}
function f_muestra_ficha_colaborador(nick, idDiv, boton) {
var urlEskup = '/Profileeskup';
var date_actual  = new Date();
var ts_actual = date_actual.getTime();
var cadena_params = 'action=info_usuarios&user=' + nick;
cadena_params += '&ts=' + parseInt(ts_actual);
EPETUtils_makeHttpRequestGet(function(httpRequest) {
if (httpRequest.status != 200) {
var hashDatos = {};
f_pinta_datos(nick, hashDatos, idDiv, boton);
}
else {
var hashDatos = Array();
var data = httpRequest.responseText;
eval("_hashDatos = " + data);
f_pinta_datos(nick, _hashDatos, idDiv, boton);
}
}, urlEskup + "?" + cadena_params);
}
function f_comprobar_submit(evento, idFormulario, idCampoLogin, idCampoPasswd) {
if (window.event) {
tecla = evento.keyCode;
src   = evento.srcElement;
}
else if (evento.which) {
tecla = evento.which;
src   = evento.target;
}
if (tecla == 13) {
f_iniciar_sesion(idFormulario, idCampoLogin, idCampoPasswd);
}
}
function f_iniciar_sesion(idFormulario, idCampoLogin, idCampoPasswd) {
var campoLogin  = document.getElementById(idCampoLogin);
var campoPasswd = document.getElementById(idCampoPasswd);
if ( (campoLogin.value == '') || (campoPasswd.value == '') )  {
alert(LANG_MSG[LANG].teclear_usuario);
return false;
}
var valor_usuario = campoLogin.value;
if ( valor_usuario.match(/(\w*)@(\w+)/) ) {
var formulario = document.getElementById(idFormulario);
formulario.submit();
}
else {
alert(LANG_MSG[LANG].error_correo);
return false;
}
}


function EPETUtils_filtraAlfanumerico (datos_contaminados)
{
var datos_filtrados= datos_contaminados.replace(/[^a-z0-9_ñÑáÁéÉíÍóÓúÚüÜ]/g, "");
return datos_filtrados;
}

function EPETUtils_filtraJavascript (datos_contaminados)
{
var datos_filtrados= datos_contaminados.replace(/[';"]/g, "");
return datos_filtrados;
}

function EPETUtils_filtraFormulario (datos_contaminados)
{
var datos_filtrados= datos_contaminados.replace(/[<>"=]/g, "");
return datos_filtrados;
}
var JSON = JSON || {};
JSON.stringify = JSON.stringify || function (obj) {
var t = typeof (obj);
if (t != "object" || obj === null) {
if (t == "string") obj = '"'+obj+'"';
return String(obj);
}
else {
var n, v, json = [], arr = (obj && obj.constructor == Array);
for (n in obj) {
v = obj[n]; t = typeof(v);
if (t == "string") v = '"'+v+'"';
else if (t == "object" && v !== null) v = JSON.stringify(v);
json.push((arr ? "" : '"' + n + '":') + String(v));
}
return (arr ? "[" : "{") + String(json) + (arr ? "]" : "}");
}
};
JSON.parse = JSON.parse || function (str) {
if (str === "") str = '""';
eval("var p=" + str + ";");
return p;
};
if (typeof(launchAjaxOMN) != 'function')
{
try{
if (typeof(parent) != "undefined" && typeof(parent.launchAjaxOMN) == 'function')
{
launchAjaxOMN = parent.launchAjaxOMN;
}
}
catch(err)
{}
}
function loadCSS(archivo_css, callback) {
var head = document.getElementsByTagName('head')[0];
var link = document.createElement('link');
link.type = "text/css";
link.rel = "stylesheet"
link.href = archivo_css;
if (link.addEventListener)
{
link.addEventListener('load', callback, false);
}
else
{
if (link.onload) {
link.onload = callback;
}
else
{
if (isIE)
{
link.onreadystatechange = function() {
var state = link.readyState;
if (state === 'loaded' || state === 'complete') {
callback();
link.onreadystatechange = null;
}
}
}
else
{
var cssnum = document.styleSheets.length;
var ti = setInterval(function() {
if (document.styleSheets.length > cssnum) {
callback();
clearInterval(ti);
}
}, 30);
}
}
}
head.appendChild(link);
}
var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="";var n,r,i,s,o,u,a;var f=0;e=Base64._utf8_encode(e);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)}return t},decode:function(e){var t="";var n,r,i;var s,o,u,a;var f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length){s=this._keyStr.indexOf(e.charAt(f++));o=this._keyStr.indexOf(e.charAt(f++));u=this._keyStr.indexOf(e.charAt(f++));a=this._keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t=t+String.fromCharCode(n);if(u!=64){t=t+String.fromCharCode(r)}if(a!=64){t=t+String.fromCharCode(i)}}t=Base64._utf8_decode(t);return t},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t},_utf8_decode:function(e){var t="";var n=0;var r=c1=c2=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){c2=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|c2&63);n+=2}else{c2=e.charCodeAt(n+1);c3=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63);n+=3}}return t}}
function loadEmbedObjectInDiv(nombreId, str)
{
var objDiv = document.getElementById(nombreId);
if (objDiv)
{
objDiv.innerHTML = str;
}
}
function loadEmbedObjectInDivResponsive(nombreId, str, responsive)
{
var objDiv = document.getElementById(nombreId);
if (objDiv)
{
if (responsive)
{
var anchoIf = /width=["']?(\d+)["']?/i;
var altoIf = /height=["']?(\d+)["']?/i;
var anchoViejo;
var altoViejo;
var anchoNuevo;
var altoNuevo;
var res = anchoIf.exec(str);
var res2;
if (res)
{
anchoViejo = res[1];
res2 = altoIf.exec(str);
if (res2)
altoViejo = res2[1];
else
altoViejo = Math.floor(anchoViejo * 9 / 16);
altoNuevo = Math.floor(objDiv.offsetWidth * altoViejo / anchoViejo);
anchoNuevo = objDiv.offsetWidth;
str = str.replace(/width=(['"]?)\d+(['"]?)/ig, "width=$1" + anchoNuevo + "$2");
str = str.replace(/height=(['"]?)\d+(['"]?)/ig, "height=$1" + altoNuevo + "$2");
str = str.replace(/w=\d+/ig, "w=" + anchoNuevo);
str = str.replace(/h=\d+/ig, "h=" + altoNuevo);
}
}
objDiv.innerHTML = str;
}
}
function aniade_track_caja(id_componente, track) {
if (document.getElementById(id_componente)) {
var caja = document.getElementById(id_componente);
if (caja.getElementsByTagName("a")) {
var enlaces = caja.getElementsByTagName("a");
for(var index in enlaces) {
var elemento = enlaces[index];
if (typeof(elemento) == 'object' && elemento.getAttribute('href')) {
var hrefInicial = elemento.getAttribute('href');
if (hrefInicial.substring(0, 4) != "java") {
var hrefFinal = "";
if (hrefInicial.indexOf('?') > -1) {
hrefFinal = hrefInicial + "&" + track;
} else {
hrefFinal = hrefInicial + "?" + track;
}
elemento.setAttribute('href',hrefFinal);
}
}
}
}
}
}
